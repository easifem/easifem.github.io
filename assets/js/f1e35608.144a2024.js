"use strict";(self.webpackChunkeasifem_docs=self.webpackChunkeasifem_docs||[]).push([[91461],{34231:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>g,default:()=>T,frontMatter:()=>j,metadata:()=>a,toc:()=>f});const a=JSON.parse('{"id":"TriangleInterpolationUtility/HeirarchicalBasis_Triangle","title":"HeirarchicalBasis_Triangle","description":"Evaluate all modal basis (heirarchical polynomial) on Triangle.","source":"@site/docs/docs-api/TriangleInterpolationUtility/HeirarchicalBasis_Triangle.md","sourceDirName":"TriangleInterpolationUtility","slug":"/TriangleInterpolationUtility/HeirarchicalBasis_Triangle","permalink":"/docs-api/TriangleInterpolationUtility/HeirarchicalBasis_Triangle","draft":false,"unlisted":false,"editUrl":"https://github.com/easifem/easifem.github.io/tree/main/docs/docs-api/TriangleInterpolationUtility/HeirarchicalBasis_Triangle.md","tags":[],"version":"current","lastUpdatedAt":1724304782000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"EquidistancePoint_Triangle","permalink":"/docs-api/TriangleInterpolationUtility/EquidistancePoint_Triangle"},"next":{"title":"InterpolationPoint_Triangle","permalink":"/docs-api/TriangleInterpolationUtility/InterpolationPoint_Triangle"}}');var r=i(23420),t=i(54213);function l(e){const n={code:"code",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-fortran",children:'program main\n  use easifembase\n  use easifemClasses\n  implicit none\n  real(dfp), allocatable :: xij(:,:), avec(:)\n  integer(i4b) :: ii, jj, cnt, n\n\n  n = 51\n  call reallocate(avec, n)\n  call reallocate(xij, 2, int((n+1)*(n+2)/2))\n  avec= linspace(0.0_DFP, 1.0_DFP, n)\n  cnt=0\n  do ii = 1, n\n    do jj = 1, n-ii+1\n      cnt=cnt+1\n      xij(1,cnt) = avec(ii)\n      xij(2,cnt) = avec(jj)\n    end do\n  end do\n\n  BLOCK\n    real(dfp), allocatable :: ans(:,:)\n    integer(i4b) :: ii, order, pe1, pe2, pe3\n    type( VTKPlot_ ) :: aplot\n    character(len=*), parameter :: fname="./results/"\n    !!\n    order=1; pe1=1; pe2=1; pe3=1\n    !!\n    ans = HeirarchicalBasis_Triangle(&\n      & order=order, pe1=pe1, pe2=pe2, pe3=pe3, &\n      & xij=xij, refTriangle="UNIT")\n    !!\n    do ii  = 1, size(ans,2)\n      call aplot%scatter3D(x=xij(1,:), y=xij(2, :), z=ans(:,ii), &\n        & filename=fname//"Ph( order=" // tostring(order) // &\n          & ", pe1="//tostring(pe1) // &\n          & ", pe2="//tostring(pe2) // &\n          & ", pe3="//tostring(pe3) // &\n          & " )" // tostring(ii) // &\n          & ".vtp", &\n        & label="P")\n    end do\n    !!\n  END BLOCK\n\nend program main\n'})})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}function s(e){const n={admonition:"admonition",code:"code",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{title:'"order=3; pe1=3; pe2=3; pe3=3"',type:"note"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-fortran",children:'program main\n  use easifembase\n  use easifemClasses\n  implicit none\n  real(dfp), allocatable :: xij(:,:), avec(:)\n  integer(i4b) :: ii, jj, cnt, n\n\n    n = 51\n    call reallocate(avec, n)\n    call reallocate(xij, 2, int((n+1)*(n+2)/2))\n    avec= linspace(0.0_DFP, 1.0_DFP, n)\n    cnt=0\n    do ii = 1, n\n      do jj = 1, n-ii+1\n        cnt=cnt+1\n        xij(1,cnt) = avec(ii)\n        xij(2,cnt) = avec(jj)\n      end do\n    end do\n\n  BLOCK\n    real(dfp), allocatable :: ans(:,:)\n    integer(i4b) :: ii, order, pe1, pe2, pe3\n    type( VTKPlot_ ) :: aplot\n    character(len=*), parameter :: fname="./results/"\n    !!\n    order=3; pe1=3; pe2=3; pe3=3\n    !!\n    ans = HeirarchicalBasis_Triangle(&\n      & order=order, pe1=pe1, pe2=pe2, pe3=pe3, &\n      & xij=xij, refTriangle="UNIT")\n    !!\n    do ii  = 1, size(ans,2)\n      call aplot%scatter3D(x=xij(1,:), y=xij(2, :), z=ans(:,ii), &\n        & filename=fname//"Ph( order=" // tostring(order) // &\n          & ", pe1="//tostring(pe1) // &\n          & ", pe2="//tostring(pe2) // &\n          & ", pe3="//tostring(pe3) // &\n          & " )" // tostring(ii) // &\n          & ".vtp", &\n        & label="P")\n    end do\n    !!\n  END BLOCK\n\nend program main\n'})})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(s,{...e})}):s(e)}function p(e){const n={admonition:"admonition",code:"code",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{title:'"order=4; pe1=4; pe2=4; pe3=4"',type:"note"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-fortran",children:'program main\n  use easifembase\n  use easifemClasses\n  implicit none\n  real(dfp), allocatable :: xij(:,:), avec(:)\n  integer(i4b) :: ii, jj, cnt, n\n\n    n = 51\n    call reallocate(avec, n)\n    call reallocate(xij, 2, int((n+1)*(n+2)/2))\n    avec= linspace(0.0_DFP, 1.0_DFP, n)\n    cnt=0\n    do ii = 1, n\n      do jj = 1, n-ii+1\n        cnt=cnt+1\n        xij(1,cnt) = avec(ii)\n        xij(2,cnt) = avec(jj)\n      end do\n    end do\n\n  BLOCK\n    real(dfp), allocatable :: ans(:,:)\n    integer(i4b) :: ii, order, pe1, pe2, pe3\n    type( VTKPlot_ ) :: aplot\n    character(len=*), parameter :: fname="./results/"\n    !!\n    order=4; pe1=4; pe2=4; pe3=4\n    !!\n    ans = HeirarchicalBasis_Triangle(&\n      & order=order, pe1=pe1, pe2=pe2, pe3=pe3, &\n      & xij=xij, refTriangle="UNIT")\n    !!\n    do ii  = 1, size(ans,2)\n      call aplot%scatter3D(x=xij(1,:), y=xij(2, :), z=ans(:,ii), &\n        & filename=fname//"Ph( order=" // tostring(order) // &\n          & ", pe1="//tostring(pe1) // &\n          & ", pe2="//tostring(pe2) // &\n          & ", pe3="//tostring(pe3) // &\n          & " )" // tostring(ii) // &\n          & ".vtp", &\n        & label="P")\n    end do\n    !!\n  END BLOCK\n\nend program main\n'})})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}function m(e){const n={admonition:"admonition",code:"code",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{title:'"order=5; pe1=1; pe2=5; pe3=3"',type:"note"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-fortran",children:'program main\n  use easifembase\n  use easifemClasses\n  implicit none\n  real(dfp), allocatable :: xij(:,:), avec(:)\n  integer(i4b) :: ii, jj, cnt, n\n\n  n = 51\n  call reallocate(avec, n)\n  call reallocate(xij, 2, int((n+1)*(n+2)/2))\n  avec= linspace(0.0_DFP, 1.0_DFP, n)\n  cnt=0\n  do ii = 1, n\n    do jj = 1, n-ii+1\n      cnt=cnt+1\n      xij(1,cnt) = avec(ii)\n      xij(2,cnt) = avec(jj)\n    end do\n  end do\n\n  BLOCK\n    real(dfp), allocatable :: ans(:,:)\n    integer(i4b) :: ii, order, pe1, pe2, pe3\n    type( VTKPlot_ ) :: aplot\n    character(len=*), parameter :: fname="./results/"\n    order=5; pe1=1; pe2=5; pe3=3\n    ans = HeirarchicalBasis_Triangle(&\n      & order=order, pe1=pe1, pe2=pe2, pe3=pe3, &\n      & xij=xij, refTriangle="UNIT")\n    do ii  = 1, size(ans,2)\n      call aplot%scatter3D(x=xij(1,:), y=xij(2, :), z=ans(:,ii), &\n        & filename=fname//"Ph( order=" // tostring(order) // &\n          & ", pe1="//tostring(pe1) // &\n          & ", pe2="//tostring(pe2) // &\n          & ", pe3="//tostring(pe3) // &\n          & " )" // tostring(ii) // &\n          & ".vtp", &\n        & label="P")\n    end do\n  END BLOCK\n\nend program main\n'})})]})}function x(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}const j={},g="HeirarchicalBasis_Triangle",h={},f=[{value:"Interface",id:"interface",level:2},{value:"example 1",id:"example-1",level:2},{value:"Example 2",id:"example-2",level:2},{value:"Example 3",id:"example-3",level:2},{value:"Example 4",id:"example-4",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components},{Details:i,TabItem:a,Tabs:l}=n;return i||v("Details",!0),a||v("TabItem",!0),l||v("Tabs",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"heirarchicalbasis_triangle",children:"HeirarchicalBasis_Triangle"})}),"\n",(0,r.jsx)(n.p,{children:"Evaluate all modal basis (heirarchical polynomial) on Triangle."}),"\n",(0,r.jsx)(n.h2,{id:"interface",children:"Interface"}),"\n",(0,r.jsxs)(l,{children:[(0,r.jsx)(a,{value:"interface",label:"\u0700 Interface",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-fortran",children:"INTERFACE\n  MODULE PURE FUNCTION HeirarchicalBasis_Triangle(order, pe1, pe2, pe3,&\n    & xij, refTriangle) RESULT(ans)\n    INTEGER(I4B), INTENT(IN) :: order\n    !! order in the cell of triangle, it should be greater than 2\n    INTEGER(I4B), INTENT(IN) :: pe1\n    !! order of interpolation on edge e1\n    INTEGER(I4B), INTENT(IN) :: pe2\n    !! order of interpolation on edge e2\n    INTEGER(I4B), INTENT(IN) :: pe3\n    !! order of interpolation on edge e3\n    REAL(DFP), INTENT(IN) :: xij(:, :)\n    !! points of evaluation in xij format\n    CHARACTER(*), INTENT(IN) :: refTriangle\n    !! reference triangle\n    REAL(DFP) :: ans( &\n      & SIZE(xij, 2), &\n      & pe1 + pe2 + pe3 + INT((order - 1) * (order - 2) / 2))\n    !!\n  END FUNCTION HeirarchicalBasis_Triangle\nEND INTERFACE\n"})})}),(0,r.jsx)(a,{value:"close",label:"\u21a2 "})]}),"\n",(0,r.jsx)(n.h2,{id:"example-1",children:"example 1"}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Example 1"}),(0,r.jsx)("div",{children:(0,r.jsx)(o,{})})]}),"\n",(0,r.jsx)(n.h2,{id:"example-2",children:"Example 2"}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Example 2"}),(0,r.jsx)("div",{children:(0,r.jsx)(c,{})})]}),"\n",(0,r.jsx)(n.h2,{id:"example-3",children:"Example 3"}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Example 3"}),(0,r.jsx)("div",{children:(0,r.jsx)(d,{})})]}),"\n",(0,r.jsx)(n.h2,{id:"example-4",children:"Example 4"}),"\n",(0,r.jsxs)(i,{children:[(0,r.jsx)("summary",{children:"Title"}),(0,r.jsx)("div",{children:(0,r.jsx)(x,{})})]})]})}function T(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}function v(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},54213:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var a=i(36672);const r={},t=a.createContext(r);function l(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);