<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://www.easifem.com/blog</id>
    <title>EASIFEM Blog</title>
    <updated>2025-12-08T00:01:37.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://www.easifem.com/blog"/>
    <subtitle>EASIFEM Blog</subtitle>
    <icon>https://www.easifem.com/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Understanding FEDOF in easifem (Part 1)]]></title>
        <id>https://www.easifem.com/blog/FEDOF/understanding-fedof-1</id>
        <link href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1"/>
        <updated>2025-12-08T00:01:37.000Z</updated>
        <summary type="html"><![CDATA[This post explains concept of FEDOF in easifem.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fedof">FEDOF<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1#fedof" class="hash-link" aria-label="Direct link to FEDOF" title="Direct link to FEDOF">​</a></h2>
<p><code>FEDOF</code> denotes the finite element degree of freedom. The concept of degree of freedom depends upon the type of finite element approximation (basis functions) used for the problem.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>These series of notes will present the FEDOF concept for for H1 conforming Hierarchical and Lagrange basis functions.</p></div></div>
<ul>
<li>For Lagrange polynomials the degree of freedoms are associatd with the nodes of the mesh. In this case, a node implies a point in the mesh. This point can be a vertex, somewhere on the edge, face, or interior of the element.</li>
<li>For Hierarchical polynmials the degree of freedoms are associated with the modes. They can be associated with nodes, edges, faces and interior of the elements. In this case the node has an abstract meaning. But we will associcate them with the vertex, edge, face, and interior basis functions.</li>
<li>In the case of H1 conforming basis functions with Hierarchical polynomials, the orientation of edge and faces with respect to the master element is very important. However, for Lagrange polynomials the orientation is not so much needed if we generate the nodes correctly for higher order mesh.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mesh-related-stuff">Mesh related stuff<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1#mesh-related-stuff" class="hash-link" aria-label="Direct link to Mesh related stuff" title="Direct link to Mesh related stuff">​</a></h2>
<p>In this note we will focus on 2D mesh with quadrilateral.</p>
<p><img decoding="async" loading="lazy" alt="Quadrilateral mesh" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHdpZHRoPSI2NTdwdCIgaGVpZ2h0PSI3MjFwdCIgdmlld0JveD0iMCAwIDY1NyA3MjEiPgo8dGl0bGU+c3F1YXJlXzN4MzwvdGl0bGU+CjxkZXNjPgpDcmVhdG9yOiBHTDJQUyAxLjQuMywgKEMpIDE5OTktMjAyMCBDLiBHZXV6YWluZQpGb3I6IEdtc2gKQ3JlYXRpb25EYXRlOiBUaHUgT2N0ICAyIDE0OjIyOjM4IDIwMjUKPC9kZXNjPgo8ZGVmcz4KPC9kZWZzPgo8Zz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iOTMuODU3MSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iNTYzLjE0MyIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iNTYzLjE0MyIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iOTMuODU3MSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iMzI4LjUiIGN5PSI1OTUuMTQzIiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjU2My4xNDMiIGN5PSIzNjAuNSIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjM2MC41IiByPSIyIi8+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjIxMS4xNzkiIHk9IjQ3Ny44MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjEzPC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIyMTEuMTc5IiB5PSIyNDMuMTc5IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNDwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNDQ1LjgyMSIgeT0iNDc3LjgyMSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTU8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjQ0NS44MjEiIHk9IjI0My4xNzkiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE2PC90ZXh0Pgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjM2MC41IiByPSIyIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgNTYzLjE0Myw1OTUuMTQzIDU2My4xNDMsMzYwLjUgNTYzLjE0MywxMjUuODU3IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUgOTMuODU3MSw1OTUuMTQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiM4YzgyZWUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgMzI4LjUsMzYwLjUgOTMuODU3MSwzNjAuNSA5My44NTcxLDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDM2MC41IDMyOC41LDM2MC41IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzMjguNSw1OTUuMTQzIDU2My4xNDMsNTk1LjE0MyA1NjMuMTQzLDM2MC41IDMyOC41LDM2MC41IDMyOC41LDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzMjguNSwzNjAuNSA1NjMuMTQzLDM2MC41IDU2My4xNDMsMTI1Ljg1NyAzMjguNSwxMjUuODU3IDMyOC41LDM2MC41Ii8+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjU5MS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjU2Ni42NDMiIHk9IjU5MS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjI8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjU2Ni42NDMiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjQ8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjMzMiIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj42PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIzMzIiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjc8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+ODwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMzMyIiB5PSIzNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjk8L3RleHQ+CjwvZz4KPC9zdmc+Cg==" width="876" height="961" class="img_ev3q"></p>
<p>Information about this domain is given below:</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">engine: GMSH 4.1 0 8</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">version: 4.1</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nsd: 2</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">minNptrs: 1</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">maxNptrs: 9</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">minElemNum: 1</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">maxElemNum: 16</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tNodes: 9</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tEntitiesForNodes: 9</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tEntitiesForElements: 9</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tElements: 4, 8, 4, 0</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">total mesh of volume: 0</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">total mesh of surface: 1</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">total mesh of curve: 4</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">total mesh of point: 4</span><br></span></code></pre></div></div>
<p>The information about the cell mesh is given below.</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">total nodes: 9</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">total elements: 4</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tEdges: 0</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tFaces: 12</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>For a 2D-mesh, we do not define the edges. For 2D mesh we only have Cell, faces, and vertices.</p></div></div>
<p>From the domain we can get the pointer to mesh of cells. In this case a cell is made of quadrilateral elements.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">cellMesh </span><span class="token operator" style="color:#179299">=&gt;</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetMeshPointer</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>We can get the maximum number of nodes in an element by using <code>GetMaxNNE()</code> method.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">maxNNE </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetMaxNNE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>For this mesh the value of <code>maxNNE</code> will be 4, as the maximum number of nodes in a quadrilateral element is 4.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>You can think maxNNE as the maximum number of vertex connectivity for elements of mesh.</p></div></div>
<p>We can get the global element number of a local element number by using following.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iel </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetGlobalElemNumber</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">localElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>"GlobalElement vs LocalElement Number"</div><div class="admonitionContent_BuS1"><p>Global element number is what you see in the mesh file, it the element number assigned by the mesh generator. Whereas, local element number is the location of this element inside the cellMesh object. We do not hope you to know the local element number, therefore, you can convert global element number to local element by using the method <code>GetLocalElemNumber()</code>.</p></div></div>
<p>In this case iel will be 13.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vertex-connectivity-of-mesh">Vertex connectivity of mesh<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1#vertex-connectivity-of-mesh" class="hash-link" aria-label="Direct link to Vertex connectivity of mesh" title="Direct link to Vertex connectivity of mesh">​</a></h2>
<p>The vertex connectivity of this element can be obtained by using the following code.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"V"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>To get vertex connectivity we use opt="V", for face connectivity we will use opt="F", for edge connectivity we will use opt="E", and for cell connectivity we will use opt="C", and for all connectivity we will use opt="A".</p></div></div>
<p>The vertex connectivity of global element 13 (local element 1) is given below.</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">1 5 9 8</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Note that the vertex connectivity is returned in terms of global vertex numbers.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="face-connectivity-of-mesh">Face connectivity of mesh<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1#face-connectivity-of-mesh" class="hash-link" aria-label="Direct link to Face connectivity of mesh" title="Direct link to Face connectivity of mesh">​</a></h2>
<p>Now lets get the face connectivity for this element.</p>
<p>We can enquire about the total number of faces in the mesh by using the method <code>GetTotalFaces()</code> as shown below.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalFaces</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total faces in mesh:"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>The face connectivity of global Element 13 (local element 1) can be obtained by using the following.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"F"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Connectivity of faces for globalElement=1: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>The result is given below.</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">1 2 3 4</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>These are local face numbers. Note that there are no global face numbers because the mesh file does not provide face number. Therefore, the concept of global or local face number is not valid here.</p></div></div>
<p>We can get the orientation of these faces by using <code>GetFaceOrientation()</code>, the face orientation is a two dimensional array, where first dimension contains the face orientation flag in two dimensions and the second dimension contains the local face number. The following code is related to getting the face orientation.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>The number of rows in faceOrientation should be 3.</p></div></div>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">orient</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> SIZE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFaceOrientation</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">orient</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                 nrow</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><span class="token operator" style="color:#179299">=</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">orient</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token string" style="color:#df8e1d">"Face orientations for globalElement=1: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>The result is given below.</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">Face orientations for globalElement=1:</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">---------------------------------------</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             1   1  -1  -1</span><br></span></code></pre></div></div>
<p>Let's understand the concept of face orientation.</p>
<p>The vertex connectivity of global element 13 is given by <code>[1 5 9 8]</code>. The faces are oriented in the counter clockwise direction.</p>
<ul>
<li>Local face 1 is form vertex 1 to vertex 5</li>
<li>Local face 2 is form vertex 5 to vertex 9</li>
<li>Local face 3 is form vertex 9 to vertex 8</li>
<li>Local face 4 is form vertex 8 to vertex 1</li>
</ul>
<p>In 2D, positive orientation of a face means from small to large vertex number. Therefore,</p>
<ul>
<li>Local face 1, form vertex 1 to vertex 5, has positive orientation.</li>
<li>Local face 2, form vertex 5 to vertex 9, has positive orientation.</li>
<li>Local face 3, form vertex 9 to vertex 8, has negative orientation.</li>
<li>Local face 4, form vertex 8 to vertex 1, has negative orientation.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>If you try to get the edge data for 2D mesh you will get nothing because edge data is note defined for 2D mesh.</p></div></div>
<p>Getting vertex connectivity of the a face. To get the node numbers of a face we need to describe the globalElement and the local face number as shown below.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFacetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iface</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Node numbers of face 1 of element 1: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFacetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iface</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Node numbers of face 2 of element 1: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFacetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iface</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Node numbers of face 3 of element 1: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFacetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iface</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Node numbers of face 4 of element 1: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>The result is given below.</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">Node numbers of face 1 of element 1: [1 5]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">Node numbers of face 2 of element 1: [5 9]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">Node numbers of face 3 of element 1: [9 8]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">Node numbers of face 4 of element 1: [8 1]</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Note these face connectivities are for local face of element.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-all-connectivity-of-mesh">Getting all connectivity of mesh<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1#getting-all-connectivity-of-mesh" class="hash-link" aria-label="Direct link to Getting all connectivity of mesh" title="Direct link to Getting all connectivity of mesh">​</a></h2>
<p>we can get all connectivity of an element by using the following code.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">'V'</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Connectivity of vertex for localElement=1: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scalar-fedof">Scalar FEDOF<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1#scalar-fedof" class="hash-link" aria-label="Direct link to Scalar FEDOF" title="Direct link to Scalar FEDOF">​</a></h2>
<p>Getting the degree of freedom for scalar field.</p>
<ul>
<li>Vertex DOF connectivity for localElement=1:</li>
</ul>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">1 5 9 8</span><br></span></code></pre></div></div>
<ul>
<li>Face DOF connectivity for localElement=1:</li>
</ul>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">10 11 12 13</span><br></span></code></pre></div></div>
<ul>
<li>Cell DOF connectivity for localElement=1:</li>
</ul>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">22</span><br></span></code></pre></div></div>
<ul>
<li>All DOF connectivity for localElement=1:</li>
</ul>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">1 5 9 8 10 11 12 13 22</span><br></span></code></pre></div></div>
<p>There is another way to get FEDOF connectivity.</p>
<p>From the cellMesh we get the connectivity with opt "V", "F", "C", and "A" for vertex, face, cell, and all DOF connectivity respectively. Then for each of these abstract node number we can call following methods on FEDOF object.</p>
<ul>
<li><code>GetVertextDOF()</code></li>
<li><code>GetFaceDOF()</code></li>
<li><code>GetCellDOF()</code></li>
</ul>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="fedof" term="fedof"/>
        <category label="basis" term="basis"/>
        <category label="shapeFunctions" term="shapeFunctions"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Understanding FEDOF in easifem (Part 2)]]></title>
        <id>https://www.easifem.com/blog/FEDOF/understanding-fedof-2</id>
        <link href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2"/>
        <updated>2025-12-08T00:01:37.000Z</updated>
        <summary type="html"><![CDATA[This post explains concept of FEDOF in easifem.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fedof">FEDOF<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#fedof" class="hash-link" aria-label="Direct link to FEDOF" title="Direct link to FEDOF">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Read the part 1 of this series <a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1">here</a> before proceeding further.</p></div></div>
<p>In this note we will study the FEDOF for scalar field using H1 conforming Hierarchical basis functions.
The main focus on the degree of freedom associated with vertex, face, and cell of the element.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mesh-related-stuff">Mesh related stuff<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#mesh-related-stuff" class="hash-link" aria-label="Direct link to Mesh related stuff" title="Direct link to Mesh related stuff">​</a></h2>
<p>In this note we will focus on 2D mesh with quadrilateral.</p>
<p><img decoding="async" loading="lazy" alt="Quadrilateral mesh" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHdpZHRoPSI2NTdwdCIgaGVpZ2h0PSI3MjFwdCIgdmlld0JveD0iMCAwIDY1NyA3MjEiPgo8dGl0bGU+c3F1YXJlXzN4MzwvdGl0bGU+CjxkZXNjPgpDcmVhdG9yOiBHTDJQUyAxLjQuMywgKEMpIDE5OTktMjAyMCBDLiBHZXV6YWluZQpGb3I6IEdtc2gKQ3JlYXRpb25EYXRlOiBUaHUgT2N0ICAyIDE0OjIyOjM4IDIwMjUKPC9kZXNjPgo8ZGVmcz4KPC9kZWZzPgo8Zz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iOTMuODU3MSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iNTYzLjE0MyIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iNTYzLjE0MyIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iOTMuODU3MSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iMzI4LjUiIGN5PSI1OTUuMTQzIiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjU2My4xNDMiIGN5PSIzNjAuNSIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjM2MC41IiByPSIyIi8+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjIxMS4xNzkiIHk9IjQ3Ny44MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjEzPC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIyMTEuMTc5IiB5PSIyNDMuMTc5IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNDwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNDQ1LjgyMSIgeT0iNDc3LjgyMSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTU8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjQ0NS44MjEiIHk9IjI0My4xNzkiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE2PC90ZXh0Pgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjM2MC41IiByPSIyIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgNTYzLjE0Myw1OTUuMTQzIDU2My4xNDMsMzYwLjUgNTYzLjE0MywxMjUuODU3IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUgOTMuODU3MSw1OTUuMTQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiM4YzgyZWUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgMzI4LjUsMzYwLjUgOTMuODU3MSwzNjAuNSA5My44NTcxLDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDM2MC41IDMyOC41LDM2MC41IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzMjguNSw1OTUuMTQzIDU2My4xNDMsNTk1LjE0MyA1NjMuMTQzLDM2MC41IDMyOC41LDM2MC41IDMyOC41LDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzMjguNSwzNjAuNSA1NjMuMTQzLDM2MC41IDU2My4xNDMsMTI1Ljg1NyAzMjguNSwxMjUuODU3IDMyOC41LDM2MC41Ii8+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjU5MS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjU2Ni42NDMiIHk9IjU5MS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjI8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjU2Ni42NDMiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjQ8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjMzMiIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj42PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIzMzIiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjc8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+ODwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMzMyIiB5PSIzNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjk8L3RleHQ+CjwvZz4KPC9zdmc+Cg==" width="876" height="961" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scalar-fedof">Scalar FEDOF<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#scalar-fedof" class="hash-link" aria-label="Direct link to Scalar FEDOF" title="Direct link to Scalar FEDOF">​</a></h2>
<p>Initiate the FEDOF object and scalar field by using the following code.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> u</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"u"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">msg</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"FEDOF info: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-all-the-connectivity">Getting all the connectivity<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#getting-all-the-connectivity" class="hash-link" aria-label="Direct link to Getting all the connectivity" title="Direct link to Getting all the connectivity">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Scalar FEDOF in global element 13" src="https://www.easifem.com/assets/images/iel1_order4-bab439c418c36e0a1607428cef7c9508.svg" width="1743" height="1700" class="img_ev3q"></p>
<p>The following code gets all the DOF in an element.</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">1   5   9   8  10  11  12  13  14  15  16  17  18  19  20  21  46  47  48  49  50  51  52  53  54</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vertex-connectivity">Vertex connectivity<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#vertex-connectivity" class="hash-link" aria-label="Direct link to Vertex connectivity" title="Direct link to Vertex connectivity">​</a></h2>
<p>Following code gets the vertex DOF connectivity.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"V"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Vertex DOF for localElement=1:"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"V"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Vertex DOF connectivity for localElement=1:"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">1 5 9 8</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>These are local DOF numbers, and it has nothing to do with the mesh connectivity.</p></div></div>
<p>We can get the DOF of a single vertex by using <code>GetVertexDOF()</code> as shown below.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">100</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">call</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemTypes">GetConnectivity_</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"V"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetVertexDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalNode</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.false.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"DOF of vertex 1 of element 1:"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="face-connectivity">Face connectivity<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#face-connectivity" class="hash-link" aria-label="Direct link to Face connectivity" title="Direct link to Face connectivity">​</a></h2>
<p>Following code gets the connectivity of all face DOF in an element. Note that these face DOF are local. In addition, they are related to the positive oriented faces only.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"F"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Face DOF for localElement=1:"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"F"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Face DOF connectivity for localElement=1:"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"R"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">10  11  12  13  14  15  16  17  18  19  20  21</span><br></span></code></pre></div></div>
<p>We can get the DOF of a face by using <code>GetFaceDOF()</code> as shown below.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">100</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemTypes">GetConnectivity_</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"F"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                               ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFaceDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                      tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"DOF on face: "</span><span class="token operator" style="color:#179299">//</span><span class="token plain">ToString</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"R"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DOF on face: 1</div><div class="admonitionContent_BuS1"><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">10  11  12</span><br></span></code></pre></div></div></div></div>
<p>Getting dof on local face 3 on element 1:</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">100</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemTypes">GetConnectivity_</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"F"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                               ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetFaceDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                      tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"DOF on face: "</span><span class="token operator" style="color:#179299">//</span><span class="token plain">ToString</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"R"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DOF of face: 3</div><div class="admonitionContent_BuS1"><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">16 17 18</span><br></span></code></pre></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cell-connectivity">Cell connectivity<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2#cell-connectivity" class="hash-link" aria-label="Direct link to Cell connectivity" title="Direct link to Cell connectivity">​</a></h2>
<p>Following code gets the connectivity of cell in an element. Note that these DOFs are local.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"C"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Cell DOF for localElement=1:"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">con </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetConnectivity</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"C"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Cell DOF connectivity for localElement=1:"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Result</div><div class="admonitionContent_BuS1"><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">46  47  48  49  50  51  52  53  54</span><br></span></code></pre></div></div></div></div>
<p>We can get the cell DOF by using <code>GetCellDOF()</code> as shown below.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">100</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> cellMesh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemTypes">GetConnectivity_</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> opt</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"C"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                               ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetCellDOF</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">globalCell</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.FALSE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ans</span><span class="token operator" style="color:#179299">=</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                      tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"DOF in cell: "</span><span class="token operator" style="color:#179299">//</span><span class="token plain">ToString</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"R"</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DOF in cell: 13</div><div class="admonitionContent_BuS1"><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">46  47  48  49  50  51  52  53  54</span><br></span></code></pre></div></div></div></div>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="fedof" term="fedof"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Understanding FEDOF in easifem (Part 3)]]></title>
        <id>https://www.easifem.com/blog/FEDOF/understanding-fedof-3</id>
        <link href="https://www.easifem.com/blog/FEDOF/understanding-fedof-3"/>
        <updated>2025-12-08T00:01:37.000Z</updated>
        <summary type="html"><![CDATA[This post explains concept of FEDOF in easifem.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fedof">FEDOF<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-3#fedof" class="hash-link" aria-label="Direct link to FEDOF" title="Direct link to FEDOF">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><ul>
<li>Read the part 1 of this series <a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-1">here</a> before proceeding further.</li>
<li>Read the part 2 of this series <a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-2">here</a> before proceeding further.</li>
</ul></div></div>
<p>In this note we will study the FEDOF for scalar field using H1 conforming Hierarchical basis functions.
The main focus is on generating quadrature points and shape functions.</p>
<p>In this note we will focus on 2D mesh with quadrilateral.</p>
<p><img decoding="async" loading="lazy" alt="Quadrilateral mesh" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHdpZHRoPSI2NTdwdCIgaGVpZ2h0PSI3MjFwdCIgdmlld0JveD0iMCAwIDY1NyA3MjEiPgo8dGl0bGU+c3F1YXJlXzN4MzwvdGl0bGU+CjxkZXNjPgpDcmVhdG9yOiBHTDJQUyAxLjQuMywgKEMpIDE5OTktMjAyMCBDLiBHZXV6YWluZQpGb3I6IEdtc2gKQ3JlYXRpb25EYXRlOiBUaHUgT2N0ICAyIDE0OjIyOjM4IDIwMjUKPC9kZXNjPgo8ZGVmcz4KPC9kZWZzPgo8Zz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iOTMuODU3MSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iNTYzLjE0MyIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iNTYzLjE0MyIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iOTMuODU3MSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iMzI4LjUiIGN5PSI1OTUuMTQzIiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjU2My4xNDMiIGN5PSIzNjAuNSIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjEyNS44NTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iOTMuODU3MSIgY3k9IjM2MC41IiByPSIyIi8+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjIxMS4xNzkiIHk9IjQ3Ny44MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjEzPC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIyMTEuMTc5IiB5PSIyNDMuMTc5IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNDwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNDQ1LjgyMSIgeT0iNDc3LjgyMSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTU8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjQ0NS44MjEiIHk9IjI0My4xNzkiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE2PC90ZXh0Pgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjM2MC41IiByPSIyIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgNTYzLjE0Myw1OTUuMTQzIDU2My4xNDMsMzYwLjUgNTYzLjE0MywxMjUuODU3IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUgOTMuODU3MSw1OTUuMTQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiM4YzgyZWUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgMzI4LjUsMzYwLjUgOTMuODU3MSwzNjAuNSA5My44NTcxLDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDM2MC41IDMyOC41LDM2MC41IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzMjguNSw1OTUuMTQzIDU2My4xNDMsNTk1LjE0MyA1NjMuMTQzLDM2MC41IDMyOC41LDM2MC41IDMyOC41LDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzMjguNSwzNjAuNSA1NjMuMTQzLDM2MC41IDU2My4xNDMsMTI1Ljg1NyAzMjguNSwxMjUuODU3IDMyOC41LDM2MC41Ii8+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjU5MS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjU2Ni42NDMiIHk9IjU5MS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjI8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjU2Ni42NDMiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjQ8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjMzMiIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj42PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIzMzIiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjc8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+ODwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMzMyIiB5PSIzNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjk8L3RleHQ+CjwvZz4KPC9zdmc+Cg==" width="876" height="961" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scalar-fedof">Scalar FEDOF<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-3#scalar-fedof" class="hash-link" aria-label="Direct link to Scalar FEDOF" title="Direct link to Scalar FEDOF">​</a></h2>
<p>Initiate the FEDOF object and scalar field by using the following code.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> u</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"u"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">msg</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"FEDOF info: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-quadrature-points">Getting quadrature points<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-3#getting-quadrature-points" class="hash-link" aria-label="Direct link to Getting quadrature points" title="Direct link to Getting quadrature points">​</a></h2>
<p>The following code gets the quadrature points in an element.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetQuadraturePoints</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">quad</span><span class="token operator" style="color:#179299">=</span><span class="token plain">qp</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> globalElement</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> islocal</span><span class="token operator" style="color:#179299">=</span><span class="token plain">yes</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">qp</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Quadrature points: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Quadrature points</div><div class="admonitionContent_BuS1"><table><thead><tr><th style="text-align:center">x1</th><th style="text-align:center">x2</th><th style="text-align:center">x3</th><th style="text-align:center">x4</th><th style="text-align:center">x5</th><th style="text-align:center">x6</th><th style="text-align:center">x7</th><th style="text-align:center">x8</th><th style="text-align:center">x9</th><th style="text-align:center">x10</th><th style="text-align:center">x11</th><th style="text-align:center">x12</th><th style="text-align:center">x13</th><th style="text-align:center">x14</th><th style="text-align:center">x15</th><th style="text-align:center">x16</th></tr></thead><tbody><tr><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.339981</td><td style="text-align:center">-0.339981</td><td style="text-align:center">-0.339981</td><td style="text-align:center">-0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.861136</td><td style="text-align:center">0.861136</td><td style="text-align:center">0.861136</td><td style="text-align:center">0.861136</td></tr><tr><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.861136</td><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.861136</td><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.861136</td><td style="text-align:center">-0.861136</td><td style="text-align:center">-0.339981</td><td style="text-align:center">0.339981</td><td style="text-align:center">0.861136</td></tr><tr><td style="text-align:center">0.121003</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.121003</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.425293</td><td style="text-align:center">0.425293</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.425293</td><td style="text-align:center">0.425293</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.121003</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.226852</td><td style="text-align:center">0.121003</td></tr></tbody></table></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-shape-functions">Getting shape functions<a href="https://www.easifem.com/blog/FEDOF/understanding-fedof-3#getting-shape-functions" class="hash-link" aria-label="Direct link to Getting shape functions" title="Direct link to Getting shape functions">​</a></h2>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="fedof" term="fedof"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Handling Dirichlet Bounding Conditions in easifem (Part 1)]]></title>
        <id>https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1</id>
        <link href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1"/>
        <updated>2025-12-08T00:01:27.000Z</updated>
        <summary type="html"><![CDATA[This post explains concept of FEDOF in easifem.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>To apply boundary condition in FEM computation, EASIFEM, provides a class called <a href="https://www.easifem.com/docs-api/DirichletBC/DirichletBC_">DirichletBC_</a>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><code>DirichletBC_</code> is a subclass of <a href="https://www.easifem.com/docs-api/AbstractBC">AbstractBC</a>.</p></div></div>
<p>To understand how <code>DirichletBC</code> works, lets consider an example of linear elasticity. Let's say we want to apply the following boundary condition.</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">u</mi><mo>=</mo><msub><mi mathvariant="bold">U</mi><mn>0</mn></msub><mo separator="true">,</mo><mtext>&nbsp;on&nbsp;</mtext><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">\mathbf{u} = \mathbf{U}_{0}, \text{ on } \Gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathbf">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord">&nbsp;on&nbsp;</span></span><span class="mord">Γ</span></span></span></span></span>
<p>We may think that there is only one boundary condition. But in easifem this is not the case. Actually, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">\mathbf{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">u</span></span></span></span>, has three components in 3D (and two components in 2D). Therefore, the above boundary condition is actually boundary condition for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">u_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">u_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">u_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. So, we have three boundary condition on a given boundary <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Γ</span></span></span></span>.</p>
<p>The second point, which is quite obvious, is that every boundary condition has two things:</p>
<ul>
<li>The boundary</li>
<li>The value (condition)</li>
</ul>
<p>To define the boundary EASIFEM employs the <a href="https://www.easifem.com/docs-api/MeshSelection">MeshSelection</a> class. The value can be specified in several ways as mentioned below in this section.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Several instances of DirichletBC can have same boundary but different condition.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mesh-and-degrees-of-freedom">Mesh and degrees of freedom<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1#mesh-and-degrees-of-freedom" class="hash-link" aria-label="Direct link to Mesh and degrees of freedom" title="Direct link to Mesh and degrees of freedom">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Degree of freedom in mesh" src="https://www.easifem.com/assets/images/order4_mesh3x3-113d1f6e4b57e8603787547132d18ba4.svg" width="2129" height="2088" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-toml">Import from toml<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1#import-from-toml" class="hash-link" aria-label="Direct link to Import from toml" title="Direct link to Import from toml">​</a></h2>
<p>We can initiate an instance of <code>DirichletBC_</code> by importing the information from a toml-file. To do so, we will use the method called <a href="https://www.easifem.com/docs-api/AbstractBC/ImportFromToml">ImportFromToml</a>.</p>
<p>Let us consider the following toml file</p>
<!-- -->
<!-- -->
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">domain</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">filename</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./mesh/square_3x3.h5"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">group</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">totalMedium</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"u"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">engine</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"NATIVE_SERIAL"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">fieldType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Normal"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">spaceCompo</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">timeCompo</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">fedofName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"space"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">geofedofName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"geofedof"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.geofedof</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseContinuity</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"H1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseInterpolation</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Lagrange"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">ipType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Equidistance"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Monomial"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.space</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseContinuity</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"H1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseInterpolation</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Hierarchical"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># ipType = "Equidistance"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># baseType = "Monomial"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">order</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">scaleForQuadOrder</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">quadOptName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"quadOpt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.space.quadOpt</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isHomogeneous</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">quadratureType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"GaussLegendre"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># order = 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"left_bottom_fix"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">idof</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">nodalValueType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Constant"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">value</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">10.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.boundary</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isSelectionByMeshID</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.boundary.meshID</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">line</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">]</span><br></span></code></pre></div></div>
<p>We use the following code to import the boundary condition from the above toml file.</p>
<!-- -->
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token comment" style="color:#5c5f77;font-style:italic">!&gt; author: Vikas Sharma, Ph. D.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! date: 2025-10-23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! summary: Study of DirichletBC class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GlobalData</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keywordExtra" style="color:#8839ef">ONLY</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain"> DFP</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> I4B</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> LGT</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ExceptionHandler_Class</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keywordExtra" style="color:#8839ef">ONLY</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain"> e</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> EXCEPTION_INFORMATION</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> DirichletBC_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FEDomain_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> AbstractMesh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FEDOF_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ScalarField_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> Display_Method</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ReallocateUtility</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">IMPLICIT NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> tomlFileName </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./test1.toml"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Types and variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">DirichletBC_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">FEDomain_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> dom</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">ScalarField_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> u</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">FEDOF_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Allocatables and pointers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">CLASS</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">AbstractMesh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">POINTER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> cellMesh</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> boundaryMesh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Setting the verbosity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! In Debug mode, there will many messages printed to the screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Following code suppress information-exception.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> e</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">setQuietMode</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">EXCEPTION_INFORMATION</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Domain: Initiate FEDomain and print info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"domain"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL dom%DisplayDomainInfo(msg="DomainInfo: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! ScalarField and FEDOF: Initiate scalarField and fedof</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> u</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"u"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">geofedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                      filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL fedof%Display(msg="FEDOF info: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Import from toml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"dbc"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL obj%Display("DirichletBC Info: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the total node numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tsize </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalNodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Node Num: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the node numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnNode</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"tsize = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ROW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnNode = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnFace = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnEdge = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the nodal values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             nrow</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><span class="token operator" style="color:#179299">=</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodalValue: "</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">[nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol]</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"[nrow, ncol]: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Cleanup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div>
<p>We obtain the following information about the boundary condition.</p>
<table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>isInit</td><td>TRUE</td></tr><tr><td>name</td><td>left_bottom_fix</td></tr><tr><td>idof</td><td>1</td></tr><tr><td>nodalValueType</td><td>CONSTANT</td></tr><tr><td>isUserFunction</td><td>FALSE</td></tr><tr><td>isUseExternal</td><td>FALSE</td></tr><tr><td>IsInitiated</td><td>TRUE</td></tr><tr><td>IsSelectionByMeshID</td><td>TRUE</td></tr><tr><td>IsSelectionByElemNum</td><td>FALSE</td></tr><tr><td>IsSelectionByNodeNum</td><td>FALSE</td></tr><tr><td>IsSelectionByBox</td><td>FALSE</td></tr><tr><td>MeshID Point</td><td>FALSE</td></tr><tr><td>MeshID Curve</td><td>TRUE</td></tr><tr><td>MeshID Surface</td><td>FALSE</td></tr><tr><td>MeshID Volume</td><td>FALSE</td></tr><tr><td>ElemNum Point</td><td>FALSE</td></tr><tr><td>ElemNum Curve</td><td>FALSE</td></tr><tr><td>ElemNum Surface</td><td>FALSE</td></tr><tr><td>ElemNum Volume</td><td>FALSE</td></tr><tr><td>NodeNum Point</td><td>FALSE</td></tr><tr><td>NodeNum Curve</td><td>FALSE</td></tr><tr><td>NodeNum Surface</td><td>FALSE</td></tr><tr><td>NodeNum Volume</td><td>FALSE</td></tr><tr><td>Box Point</td><td>FALSE</td></tr><tr><td>Box Curve</td><td>FALSE</td></tr><tr><td>Box Surface</td><td>FALSE</td></tr><tr><td>Box Volume</td><td>FALSE</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-total-node-numbers">Getting Total Node Numbers<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1#getting-total-node-numbers" class="hash-link" aria-label="Direct link to Getting Total Node Numbers" title="Direct link to Getting Total Node Numbers">​</a></h2>
<p>To get the total number of nodes where the boundary condition is applied, we can use the method called <a href="https://www.easifem.com/docs-api/AbstractBC/GetTotalNodeNum">GetTotalNodeNum</a>.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalNodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Node Num: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Results</div><div class="admonitionContent_BuS1"><p>Total Node Num: 18</p></div></div>
<p>There is a total of 18 nodes where the boundary condition is applied. Actually, node number 1 is counted two times because it is common to bottom and left boundaries.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-node-numbers">Getting Node Numbers<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1#getting-node-numbers" class="hash-link" aria-label="Direct link to Getting Node Numbers" title="Direct link to Getting Node Numbers">​</a></h2>
<p>To get the node numbers we call <a href="https://www.easifem.com/docs-api/AbstractBC/Get">Get</a> method. These node numbers are degrees of freedom numbers for FEDOF. You can use these indices to set and get the values in node fields.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnNode</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"tsize = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ROW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnNode = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnFace = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnEdge = "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Results</div><div class="admonitionContent_BuS1"><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                nodeNum</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">----------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"> 1   5   2   4   8   1  10  11  12  31  32  33  28  29  30  19  20  21</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iNodeOnNode = 1</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iNodeOnFace = 7</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iNodeOnEdge = 19</span><br></span></code></pre></div></div><ul>
<li>Node number 1 to 6 (7-1) are vertex dof numbers.</li>
<li>Node number 7 to 18 (19-1) are face dof numbers</li>
<li>Node number 19 to 18 are edge dof numbers (There are no edges)</li>
</ul></div></div>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="fedof" term="fedof"/>
        <category label="dirichletBC" term="dirichletBC"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Handling Dirichlet Bounding Conditions in easifem (Part 2)]]></title>
        <id>https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2</id>
        <link href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2"/>
        <updated>2025-12-08T00:01:27.000Z</updated>
        <summary type="html"><![CDATA[This post explains concept of Dirichlet Boundary Condition in EASIFEM]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Before reading this post, it is recommended to read <a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-1">Handling Dirichlet Bounding Conditions in easifem (Part 1)</a> first.</p></div></div>
<p>In this example, Dirichlet boundary conditions is given by a user defined function.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mesh-and-degrees-of-freedom">Mesh and degrees of freedom<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#mesh-and-degrees-of-freedom" class="hash-link" aria-label="Direct link to Mesh and degrees of freedom" title="Direct link to Mesh and degrees of freedom">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Degree of freedom in mesh" src="https://www.easifem.com/assets/images/order4_mesh3x3-113d1f6e4b57e8603787547132d18ba4.svg" width="2129" height="2088" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-toml">Import from toml<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#import-from-toml" class="hash-link" aria-label="Direct link to Import from toml" title="Direct link to Import from toml">​</a></h2>
<p>We can initiate an instance of <code>DirichletBC_</code> by importing the information from a toml-file. To do so, we will use the method called <a href="https://www.easifem.com/docs-api/AbstractBC/ImportFromToml">ImportFromToml</a>.</p>
<p>Let us consider the following toml file</p>
<!-- -->
<!-- -->
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">domain</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">filename</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./mesh/square_3x3.h5"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">group</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">totalMedium</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"u"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">engine</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"NATIVE_SERIAL"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">fieldType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Normal"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">spaceCompo</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">timeCompo</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">fedofName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"space"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">geofedofName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"geofedof"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.geofedof</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseContinuity</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"H1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseInterpolation</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Lagrange"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">ipType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Equidistance"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Monomial"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.space</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseContinuity</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"H1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseInterpolation</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Hierarchical"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># ipType = "Equidistance"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># baseType = "Monomial"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">order</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">scaleForQuadOrder</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">quadOptName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"quadOpt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.space.quadOpt</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isHomogeneous</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">quadratureType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"GaussLegendre"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># order = 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Bottom Space UserFunction"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">idof</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">nodalValueType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Space"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isUserFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.function</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"func"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">returnType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Scalar"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">numReturns</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">argType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Space"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">numArgs</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">luaScript</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"test2.lua"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">luaFunctionName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"BottomFunc"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.boundary</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isSelectionByMeshID</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.boundary.meshID</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">line</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">]</span><br></span></code></pre></div></div>
<p>We use the following code to import the boundary condition from the above toml file.</p>
<!-- -->
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token comment" style="color:#5c5f77;font-style:italic">!&gt; author: Vikas Sharma, Ph. D.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! date: 2025-10-23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! summary: Study of DirichletBC class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GlobalData</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keywordExtra" style="color:#8839ef">ONLY</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain"> DFP</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> I4B</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> LGT</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ExceptionHandler_Class</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keywordExtra" style="color:#8839ef">ONLY</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain"> e</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> EXCEPTION_INFORMATION</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> DirichletBC_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FEDomain_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> AbstractMesh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FEDOF_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ScalarField_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> Display_Method</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ReallocateUtility</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">IMPLICIT NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> tomlFileName </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./test2.toml"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Types and variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">DirichletBC_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">FEDomain_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> dom</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">ScalarField_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> u</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">FEDOF_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Allocatables and pointers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">CLASS</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">AbstractMesh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">POINTER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> cellMesh</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> boundaryMesh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Setting the verbosity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! In Debug mode, there will many messages printed to the screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Following code suppress information-exception.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL e%setQuietMode(EXCEPTION_INFORMATION, .TRUE.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Domain: Initiate FEDomain and print info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"domain"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL dom%DisplayDomainInfo(msg="DomainInfo: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! ScalarField and FEDOF: Initiate scalarField and fedof</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> u</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"u"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">geofedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                      filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL fedof%Display(msg="FEDOF info: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Import from toml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"dbc"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL obj%Display("DirichletBC Info: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the total node numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tsize </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalNodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Node Num: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the node numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnNode</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"tsize = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ROW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnNode = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnFace = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnEdge = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the nodal values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">SHAPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"shape(nodalValue) before Get: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nrow </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">0</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> ncol </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">geofedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             nodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nrow</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><span class="token operator" style="color:#179299">=</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum(1:nrow): "</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> advance</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"NO"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodalValue: "</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">[nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol]</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"[nrow, ncol]: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Cleanup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div>
<p>We obtain the following information about the boundary condition.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Results</div><div class="admonitionContent_BuS1"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dirichletbc-info">DirichletBC Info<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#dirichletbc-info" class="hash-link" aria-label="Direct link to DirichletBC Info" title="Direct link to DirichletBC Info">​</a></h4><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>isInit</td><td>TRUE</td></tr><tr><td>name</td><td>Bottom Space UserFunction</td></tr><tr><td>idof</td><td>1</td></tr><tr><td>nodalValueType</td><td>SPACE</td></tr><tr><td>isUserFunction</td><td>TRUE</td></tr><tr><td>isUseExternal</td><td>FALSE</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="boundary">Boundary<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#boundary" class="hash-link" aria-label="Direct link to Boundary" title="Direct link to Boundary">​</a></h4><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>IsInitiated</td><td>TRUE</td></tr><tr><td>IsSelectionByMeshID</td><td>TRUE</td></tr><tr><td>IsSelectionByElemNum</td><td>FALSE</td></tr><tr><td>IsSelectionByNodeNum</td><td>FALSE</td></tr><tr><td>IsSelectionByBox</td><td>FALSE</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="allocation-status">Allocation Status<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#allocation-status" class="hash-link" aria-label="Direct link to Allocation Status" title="Direct link to Allocation Status">​</a></h4><table><thead><tr><th>Element Type</th><th>Point</th><th>Curve</th><th>Surface</th><th>Volume</th></tr></thead><tbody><tr><td>MeshID ALLOCATED</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>ElemNum ALLOCATED</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>NodeNum ALLOCATED</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>Box ALLOCATED</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr></tbody></table></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-total-node-numbers">Getting Total Node Numbers<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#getting-total-node-numbers" class="hash-link" aria-label="Direct link to Getting Total Node Numbers" title="Direct link to Getting Total Node Numbers">​</a></h2>
<p>To get the total number of nodes where the boundary condition is applied, we can use the method called <a href="https://www.easifem.com/docs-api/AbstractBC/GetTotalNodeNum">GetTotalNodeNum</a>.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalNodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Node Num: "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Results</div><div class="admonitionContent_BuS1"><p>Total Node Num: 9</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-node-numbers">Getting Node Numbers<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-2#getting-node-numbers" class="hash-link" aria-label="Direct link to Getting Node Numbers" title="Direct link to Getting Node Numbers">​</a></h2>
<p>To get the node numbers we call <a href="https://www.easifem.com/docs-api/AbstractBC/Get">Get</a> method. These node numbers are degrees of freedom numbers for FEDOF. You can use these indices to set and get the values in node fields.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnNode</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"tsize = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ROW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnNode = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnFace = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnEdge = "</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Results</div><div class="admonitionContent_BuS1"><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">              nodeNum</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">----------------------------------</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"> 1   5   2  10  11  12  31  32  33</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iNodeOnNode = 1</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iNodeOnFace = 4</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">iNodeOnEdge = 10</span><br></span></code></pre></div></div><ul>
<li>Node number 1 to 3 are vertex dof numbers.</li>
<li>Node number 4 to 9 are face dof numbers</li>
</ul></div></div>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="fedof" term="fedof"/>
        <category label="dirichletBC" term="dirichletBC"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Creating structured mesh in 2D using EASIFEM]]></title>
        <id>https://www.easifem.com/blog/generating-2d-mesh-in-easifem</id>
        <link href="https://www.easifem.com/blog/generating-2d-mesh-in-easifem"/>
        <updated>2025-06-02T04:27:15.000Z</updated>
        <summary type="html"><![CDATA[This post explains methods of creating 2D mesh in easifem.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-structured-mesh-of-quadrangles">Creating a structured mesh of quadrangles<a href="https://www.easifem.com/blog/generating-2d-mesh-in-easifem#creating-a-structured-mesh-of-quadrangles" class="hash-link" aria-label="Direct link to Creating a structured mesh of quadrangles" title="Direct link to Creating a structured mesh of quadrangles">​</a></h2>
<p>To create a structured mesh of quadrangles in easifem, we will need following classes:</p>
<ul>
<li>GmshStructuredMesh_Class: This is high-level interface on top of Gmsh library to create structured meshes.</li>
<li>Gmsh_Class: Interface to Gmsh library.</li>
<li>MSHFile_Class: Reading gmsh files</li>
<li>HDF5File_Class: Writing gmsh files to HDF5 file.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Very small mesh of quadrangles" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHdpZHRoPSI2NTdwdCIgaGVpZ2h0PSI3MjFwdCIgdmlld0JveD0iMCAwIDY1NyA3MjEiPgo8dGl0bGU+dmVyeV9zbWFsbF9xdWFkNF9tZXNoPC90aXRsZT4KPGRlc2M+CkNyZWF0b3I6IEdMMlBTIDEuNC4zLCAoQykgMTk5OS0yMDIwIEMuIEdldXphaW5lCkZvcjogR21zaApDcmVhdGlvbkRhdGU6IFRodSBKdW4gIDUgMDg6NDQ6NTIgMjAyNQo8L2Rlc2M+CjxkZWZzPgo8L2RlZnM+CjxnPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI5My44NTcxIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI1NjMuMTQzIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI5My44NTcxIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI1NjMuMTQzIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI5My44NTcxIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI1NjMuMTQzIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI5My44NTcxIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI1NjMuMTQzIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iMzI4LjUiIGN5PSIxMjUuODU3IiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjkzLjg1NzEiIGN5PSIzNjAuNSIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI1NjMuMTQzIiBjeT0iMzYwLjUiIHI9IjIiLz4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iMjExLjE3OSIgeT0iNDc3LjgyMSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjIxMS4xNzkiIHk9IjI0My4xNzkiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE0PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSI0NDUuODIxIiB5PSI0NzcuODIxIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNTwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNDQ1LjgyMSIgeT0iMjQzLjE3OSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTY8L3RleHQ+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjMyOC41IiBjeT0iMzYwLjUiIHI9IjIiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDU5NS4xNDMgMzI4LjUsNTk1LjE0MyA1NjMuMTQzLDU5NS4xNDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDEyNS44NTcgMzI4LjUsMTI1Ljg1NyA1NjMuMTQzLDEyNS44NTciLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDU5NS4xNDMgOTMuODU3MSwzNjAuNSA5My44NTcxLDEyNS44NTciLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI1NjMuMTQzLDU5NS4xNDMgNTYzLjE0MywzNjAuNSA1NjMuMTQzLDEyNS44NTciLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI5My44NTcxLDU5NS4xNDMgMzI4LjUsNTk1LjE0MyAzMjguNSwzNjAuNSA5My44NTcxLDM2MC41IDkzLjg1NzEsNTk1LjE0MyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOGM4MmVlIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjkzLjg1NzEsMzYwLjUgMzI4LjUsMzYwLjUgMzI4LjUsMTI1Ljg1NyA5My44NTcxLDEyNS44NTcgOTMuODU3MSwzNjAuNSIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOGM4MmVlIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjMyOC41LDU5NS4xNDMgNTYzLjE0Myw1OTUuMTQzIDU2My4xNDMsMzYwLjUgMzI4LjUsMzYwLjUgMzI4LjUsNTk1LjE0MyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOGM4MmVlIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjMyOC41LDM2MC41IDU2My4xNDMsMzYwLjUgNTYzLjE0MywxMjUuODU3IDMyOC41LDEyNS44NTcgMzI4LjUsMzYwLjUiLz4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iOTcuMzU3MSIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MjwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iOTcuMzU3MSIgeT0iMTIyLjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MzwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iMTIyLjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NDwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMzMyIiB5PSI1OTEuNjQzIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj41PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIzMzIiIHk9IjEyMi4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjY8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9Ijk3LjM1NzEiIHk9IjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NzwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj44PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIzMzIiIHk9IjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+OTwvdGV4dD4KPC9nPgo8L3N2Zz4K" width="876" height="961" class="img_ev3q"></p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GmshStructuredMesh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> Gmsh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FPL</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GlobalData</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> MSHFIle_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> HDF5File_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">IMPLICIT NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">GmshStructuredMesh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">Gmsh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> gmsh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">ParameterList_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> param</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CHARACTER(*), PARAMETER :: title = "small_quad4_mesh"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> title </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"very_small_quad4_mesh"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> pointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">0.0</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1.0</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> pointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">0.0</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1.0</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> transfinitePointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">3</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> transfinitePointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">3</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> ierr</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">MSHFile_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> mshFile</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">HDF5File_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> hdf5file</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> FPL_Init</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> param</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> SetGmshStructuredMeshParam</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">".msh"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                pointsOnAxis1</span><span class="token operator" style="color:#179299">=</span><span class="token plain">pointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                pointsOnAxis2</span><span class="token operator" style="color:#179299">=</span><span class="token plain">pointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                          transfinitePointsOnAxis1</span><span class="token operator" style="color:#179299">=</span><span class="token plain">transfinitePointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                          transfinitePointsOnAxis2</span><span class="token operator" style="color:#179299">=</span><span class="token plain">transfinitePointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                recombineAll</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">initialize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%add</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token string" style="color:#df8e1d">"GmshStructuredMesh2D"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Generate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">gmsh</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! ierr = gmsh%fltk%run()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">finalize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> param</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.msh'</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> STATUS</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"OLD"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ACTION</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"READ"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">READ</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.h5'</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> MODE</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"NEW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Export</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">hdf5</span><span class="token operator" style="color:#179299">=</span><span class="token plain">hdf5file</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> group</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">""</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-structured-mesh-of-quadrangles-with-two-regions">Creating a structured mesh of quadrangles with two regions<a href="https://www.easifem.com/blog/generating-2d-mesh-in-easifem#creating-a-structured-mesh-of-quadrangles-with-two-regions" class="hash-link" aria-label="Direct link to Creating a structured mesh of quadrangles with two regions" title="Direct link to Creating a structured mesh of quadrangles with two regions">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Very small mesh of quadrangles with two regions" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHdpZHRoPSIxMzE0cHQiIGhlaWdodD0iMTQ0MnB0IiB2aWV3Qm94PSIwIDAgMTMxNCAxNDQyIj4KPHRpdGxlPnZlcnlfc21hbGxfcXVhZDRfbWVzaF90d29fcmVnaW9uPC90aXRsZT4KPGRlc2M+CkNyZWF0b3I6IEdMMlBTIDEuNC4zLCAoQykgMTk5OS0yMDIwIEMuIEdldXphaW5lCkZvcjogR21zaApDcmVhdGlvbkRhdGU6IFNhdCBNYXkgMzEgMDA6NDU6MjMgMjAyNQo8L2Rlc2M+CjxkZWZzPgo8L2RlZnM+CjxnPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSIxODcuNzE0IiBjeT0iOTU1LjY0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI2NTciIGN5PSI5NTUuNjQzIiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzVhNWE1YSIgY3g9IjExMjYuMjkiIGN5PSI5NTUuNjQzIiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzVhNWE1YSIgY3g9IjE4Ny43MTQiIGN5PSI0ODYuMzU3IiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzVhNWE1YSIgY3g9IjY1NyIgY3k9IjQ4Ni4zNTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjNWE1YTVhIiBjeD0iMTEyNi4yOSIgY3k9IjQ4Ni4zNTciIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iMTg3LjcxNCIgY3k9Ijk1NS42NDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNjU3IiBjeT0iOTU1LjY0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIxMTI2LjI5IiBjeT0iOTU1LjY0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIxODcuNzE0IiBjeT0iNDg2LjM1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI2NTciIGN5PSI0ODYuMzU3IiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjExMjYuMjkiIGN5PSI0ODYuMzU3IiByPSIyIi8+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjMwNS4wMzYiIHk9Ijk1NS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjc8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjUzOS42NzkiIHk9Ijk1NS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjg8L3RleHQ+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjQyMi4zNTciIGN5PSI5NTUuNjQzIiByPSIyIi8+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9Ijc3NC4zMjEiIHk9Ijk1NS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjk8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjEwMDguOTYiIHk9Ijk1NS42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjEwPC90ZXh0Pgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI4OTEuNjQzIiBjeT0iOTU1LjY0MyIgcj0iMiIvPgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIzMDUuMDM2IiB5PSI0ODYuMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xMTwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNTM5LjY3OSIgeT0iNDg2LjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTI8L3RleHQ+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjQyMi4zNTciIGN5PSI0ODYuMzU3IiByPSIyIi8+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9Ijc3NC4zMjEiIHk9IjQ4Ni4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjEzPC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIxMDA4Ljk2IiB5PSI0ODYuMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNDwvdGV4dD4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iODkxLjY0MyIgY3k9IjQ4Ni4zNTciIHI9IjIiLz4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iMTg3LjcxNCIgeT0iNzIxIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNTwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNjU3IiB5PSI3MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE2PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIxMTI2LjI5IiB5PSI3MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE3PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIzMDUuMDM2IiB5PSI3MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE4PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSI1MzkuNjc5IiB5PSI3MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE5PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSI3NzQuMzIxIiB5PSI3MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjIwPC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIxMDA4Ljk2IiB5PSI3MjEiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjIxPC90ZXh0Pgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjE4Ny43MTQsOTU1LjY0MyA0MjIuMzU3LDk1NS42NDMgNjU3LDk1NS42NDMgODkxLjY0Myw5NTUuNjQzIDExMjYuMjksOTU1LjY0MyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjE4Ny43MTQsNDg2LjM1NyA0MjIuMzU3LDQ4Ni4zNTcgNjU3LDQ4Ni4zNTcgODkxLjY0Myw0ODYuMzU3IDExMjYuMjksNDg2LjM1NyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjE4Ny43MTQsOTU1LjY0MyAxODcuNzE0LDQ4Ni4zNTciLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI2NTcsOTU1LjY0MyA2NTcsNDg2LjM1NyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjExMjYuMjksOTU1LjY0MyAxMTI2LjI5LDQ4Ni4zNTciLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIxODcuNzE0LDk1NS42NDMgNDIyLjM1Nyw5NTUuNjQzIDQyMi4zNTcsNDg2LjM1NyAxODcuNzE0LDQ4Ni4zNTcgMTg3LjcxNCw5NTUuNjQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiM4YzgyZWUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iNDIyLjM1Nyw5NTUuNjQzIDY1Nyw5NTUuNjQzIDY1Nyw0ODYuMzU3IDQyMi4zNTcsNDg2LjM1NyA0MjIuMzU3LDk1NS42NDMiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzhjODJlZSIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSI2NTcsOTU1LjY0MyA4OTEuNjQzLDk1NS42NDMgODkxLjY0Myw0ODYuMzU3IDY1Nyw0ODYuMzU3IDY1Nyw5NTUuNjQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiM4YzgyZWUiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iODkxLjY0Myw5NTUuNjQzIDExMjYuMjksOTU1LjY0MyAxMTI2LjI5LDQ4Ni4zNTcgODkxLjY0Myw0ODYuMzU3IDg5MS42NDMsOTU1LjY0MyIvPgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIxOTQuNzE0IiB5PSI5NDguNjQzIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xPC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSI2NjQiIHk9Ijk0OC42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjI8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjExMzMuMjkiIHk9Ijk0OC42NDMiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjE5NC43MTQiIHk9IjQ3OS4zNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjQ8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjY2NCIgeT0iNDc5LjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMTEzMy4yOSIgeT0iNDc5LjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NjwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNDI5LjM1NyIgeT0iOTQ4LjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NzwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iODk4LjY0MyIgeT0iOTQ4LjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+ODwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNDI5LjM1NyIgeT0iNDc5LjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+OTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iODk4LjY0MyIgeT0iNDc5LjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTA8L3RleHQ+CjwvZz4KPC9zdmc+Cg==" width="1752" height="1923" class="img_ev3q"></p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GmshStructuredMesh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> Gmsh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FPL</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GlobalData</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> MSHFile_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> HDF5File_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">IMPLICIT NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">GmshStructuredMesh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">Gmsh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> gmsh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">ParameterList_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> param</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> title </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"very_small_quad4_mesh_two_region"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> pointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">0.0</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1.0</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2.0</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> pointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">0.0</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1.0</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> transfinitePointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> transfinitePointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> [</span><span class="token number" style="color:#dc8a78">2</span><span class="token plain">]</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> ierr</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">MSHFile_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> mshFile</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">HDF5File_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> hdf5file</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> FPL_Init</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> param</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> SetGmshStructuredMeshParam</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">".msh"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  pointsOnAxis1</span><span class="token operator" style="color:#179299">=</span><span class="token plain">pointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  pointsOnAxis2</span><span class="token operator" style="color:#179299">=</span><span class="token plain">pointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  transfinitePointsOnAxis1</span><span class="token operator" style="color:#179299">=</span><span class="token plain">transfinitePointsOnAxis1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  transfinitePointsOnAxis2</span><span class="token operator" style="color:#179299">=</span><span class="token plain">transfinitePointsOnAxis2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  recombineAll</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">initialize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%add</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token string" style="color:#df8e1d">"GmshStructuredMesh2D"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Generate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">gmsh</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! ierr = gmsh%fltk%run()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">finalize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> param</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.msh'</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> STATUS</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"OLD"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ACTION</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"READ"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">READ</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.h5'</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> MODE</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"NEW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Export</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">hdf5</span><span class="token operator" style="color:#179299">=</span><span class="token plain">hdf5file</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> group</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">""</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-structured-mesh-of-triangles">Creating a structured mesh of triangles<a href="https://www.easifem.com/blog/generating-2d-mesh-in-easifem#creating-a-structured-mesh-of-triangles" class="hash-link" aria-label="Direct link to Creating a structured mesh of triangles" title="Direct link to Creating a structured mesh of triangles">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Small mesh of linear triangles" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogICAgIHdpZHRoPSI2NTdwdCIgaGVpZ2h0PSI3MjFwdCIgdmlld0JveD0iMCAwIDY1NyA3MjEiPgo8dGl0bGU+c21hbGxfdHJpM19tZXNoPC90aXRsZT4KPGRlc2M+CkNyZWF0b3I6IEdMMlBTIDEuNC4zLCAoQykgMTk5OS0yMDIwIEMuIEdldXphaW5lCkZvcjogR21zaApDcmVhdGlvbkRhdGU6IFRodSBKdW4gIDUgMDg6Mzc6MTAgMjAyNQo8L2Rlc2M+CjxkZWZzPgo8L2RlZnM+CjxnPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI5My44NTcxIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI1NjMuMTQzIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI1NjMuMTQzIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiM1YTVhNWEiIGN4PSI5My44NTcxIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI5My44NTcxIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI1NjMuMTQzIiBjeT0iNTk1LjE0MyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI1NjMuMTQzIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI5My44NTcxIiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzMjguNSIgY3k9IjU5NS4xNDMiIHI9IjIiLz4KPGNpcmNsZSBmaWxsPSIjMDAwMGZmIiBjeD0iNTYzLjE0MyIgY3k9IjM2MC41IiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjMyOC41IiBjeT0iMTI1Ljg1NyIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSI5My44NTcxIiBjeT0iMzYwLjUiIHI9IjIiLz4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNTA4LjA2NyIgeT0iMjU5Ljc5OSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjE1Mi41MTgiIHk9IjQ1OC4yNjgiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE0PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIyMzAuNzMyIiB5PSI1MzYuNDgyIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xNTwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iNDI5Ljg1MyIgeT0iMTgxLjU4NSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTY8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjQ0MC45MzMiIHk9IjU1MS4xNDciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjE3PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSI1MTkuMTQ3IiB5PSI0NzIuOTMzIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4xODwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iMjE4LjAyMiIgeT0iMTcxLjgwOCIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTk8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjEzOS44MDgiIHk9IjI1MC4wMjIiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjIwPC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSI0NjQuMDcxIiB5PSIzNzIuMjMyIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4yMTwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iMTk4LjQ2OSIgeT0iMzQ3Ljc5IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4yMjwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iMjk5LjgyMSIgeT0iMzI1LjMwNCIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MjM8L3RleHQ+Cjx0ZXh0IGZpbGw9IiM1NTU1NTUiIHg9IjM0My4xNjUiIHk9IjQ5Mi40ODciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjI0PC90ZXh0Pgo8dGV4dCBmaWxsPSIjNTU1NTU1IiB4PSIzNjYuMzA0IiB5PSIzOTEuNzg2IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4yNTwvdGV4dD4KPHRleHQgZmlsbD0iIzU1NTU1NSIgeD0iMzE5LjM3NSIgeT0iMjI3LjUzNiIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MjY8L3RleHQ+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjIzMS43MSIgY3k9IjI2My43MSIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIyNjkuODM5IiBjeT0iNDE5LjE2MSIgcj0iMiIvPgo8Y2lyY2xlIGZpbGw9IiMwMDAwZmYiIGN4PSIzOTcuOTE1IiBjeT0iMjkzLjA0IiByPSIyIi8+CjxjaXJjbGUgZmlsbD0iIzAwMDBmZiIgY3g9IjQzMS4xNTYiIGN5PSI0NjMuMTU2IiByPSIyIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgNTYzLjE0Myw1OTUuMTQzIDU2My4xNDMsMzYwLjUgNTYzLjE0MywxMjUuODU3IDMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDkzLjg1NzEsMzYwLjUgOTMuODU3MSw1OTUuMTQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNhYmExZmYiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iNTYzLjE0MywzNjAuNSA1NjMuMTQzLDEyNS44NTcgMzk3LjkxNSwyOTMuMDQgNTYzLjE0MywzNjAuNSIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjkzLjg1NzEsMzYwLjUgOTMuODU3MSw1OTUuMTQzIDI2OS44MzksNDE5LjE2MSA5My44NTcxLDM2MC41Ii8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNhYmExZmYiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iOTMuODU3MSw1OTUuMTQzIDMyOC41LDU5NS4xNDMgMjY5LjgzOSw0MTkuMTYxIDkzLjg1NzEsNTk1LjE0MyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjU2My4xNDMsMTI1Ljg1NyAzMjguNSwxMjUuODU3IDM5Ny45MTUsMjkzLjA0IDU2My4xNDMsMTI1Ljg1NyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjMyOC41LDU5NS4xNDMgNTYzLjE0Myw1OTUuMTQzIDQzMS4xNTYsNDYzLjE1NiAzMjguNSw1OTUuMTQzIi8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNhYmExZmYiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iNTYzLjE0Myw1OTUuMTQzIDU2My4xNDMsMzYwLjUgNDMxLjE1Niw0NjMuMTU2IDU2My4xNDMsNTk1LjE0MyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjMyOC41LDEyNS44NTcgOTMuODU3MSwxMjUuODU3IDIzMS43MSwyNjMuNzEgMzI4LjUsMTI1Ljg1NyIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjkzLjg1NzEsMTI1Ljg1NyA5My44NTcxLDM2MC41IDIzMS43MSwyNjMuNzEgOTMuODU3MSwxMjUuODU3Ii8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNhYmExZmYiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iNTYzLjE0MywzNjAuNSAzOTcuOTE1LDI5My4wNCA0MzEuMTU2LDQ2My4xNTYgNTYzLjE0MywzNjAuNSIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjIzMS43MSwyNjMuNzEgOTMuODU3MSwzNjAuNSAyNjkuODM5LDQxOS4xNjEgMjMxLjcxLDI2My43MSAyNjkuODM5LDQxOS4xNjEgMzk3LjkxNSwyOTMuMDQgMjMxLjcxLDI2My43MSIvPgo8cG9seWxpbmUgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYWJhMWZmIiBzdHJva2Utd2lkdGg9IjEiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBwb2ludHM9IjI2OS44MzksNDE5LjE2MSAzMjguNSw1OTUuMTQzIDQzMS4xNTYsNDYzLjE1NiAyNjkuODM5LDQxOS4xNjEiLz4KPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2FiYTFmZiIgc3Ryb2tlLXdpZHRoPSIxIiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgcG9pbnRzPSIzOTcuOTE1LDI5My4wNCAyNjkuODM5LDQxOS4xNjEgNDMxLjE1Niw0NjMuMTU2IDM5Ny45MTUsMjkzLjA0Ii8+Cjxwb2x5bGluZSBmaWxsPSJub25lIiBzdHJva2U9IiNhYmExZmYiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHBvaW50cz0iMzI4LjUsMTI1Ljg1NyAyMzEuNzEsMjYzLjcxIDM5Ny45MTUsMjkzLjA0IDMyOC41LDEyNS44NTciLz4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iOTcuMzU3MSIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iNTkxLjY0MyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MjwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iNTY2LjY0MyIgeT0iMTIyLjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MzwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iOTcuMzU3MSIgeT0iMTIyLjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NDwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMzMyIiB5PSI1OTEuNjQzIiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj41PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSI1NjYuNjQzIiB5PSIzNTciIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjY8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjMzMiIgeT0iMTIyLjM1NyIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+NzwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iOTcuMzU3MSIgeT0iMzU3IiBmb250LXNpemU9IjE1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGR5PSIwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj44PC90ZXh0Pgo8dGV4dCBmaWxsPSIjMDAwMGZmIiB4PSIyMzUuMjEiIHk9IjI2MC4yMSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+OTwvdGV4dD4KPHRleHQgZmlsbD0iIzAwMDBmZiIgeD0iMjczLjMzOSIgeT0iNDE1LjY2MSIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTA8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjQwMS40MTUiIHk9IjI4OS41NCIgZm9udC1zaXplPSIxNSIgdGV4dC1hbmNob3I9InN0YXJ0IiBkeT0iMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI+MTE8L3RleHQ+Cjx0ZXh0IGZpbGw9IiMwMDAwZmYiIHg9IjQzNC42NTYiIHk9IjQ1OS42NTYiIGZvbnQtc2l6ZT0iMTUiIHRleHQtYW5jaG9yPSJzdGFydCIgZHk9IjAiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPjEyPC90ZXh0Pgo8L2c+Cjwvc3ZnPgo=" width="876" height="961" class="img_ev3q"></p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> easifemBase</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> Gmsh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> HDF5File_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> MSHFile_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">Gmsh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> gmsh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token keyword" style="color:#8839ef">LEN</span><span class="token operator" style="color:#179299">=</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> title </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"small_tri3_mesh"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> lx </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> ly </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> order </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> meshSize </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> corner</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">0.0_DFP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> ierr</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> x</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> lc</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">MSHFile_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> mshFile</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">HDF5File_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> hdf5file</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initialize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%add</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">title</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">x </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> corner</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> y </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> corner</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> z </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> corner</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> lc </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> meshSize</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addPoint</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">x</span><span class="token operator" style="color:#179299">=</span><span class="token plain">x</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> y</span><span class="token operator" style="color:#179299">=</span><span class="token plain">y</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> z</span><span class="token operator" style="color:#179299">=</span><span class="token plain">z</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> meshSize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">lc</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tag</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">x </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> x </span><span class="token operator" style="color:#179299">+</span><span class="token plain"> lx</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> y </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> y</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> z </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> z</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> lc </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> lc</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addPoint</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">x</span><span class="token operator" style="color:#179299">=</span><span class="token plain">x</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> y</span><span class="token operator" style="color:#179299">=</span><span class="token plain">y</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> z</span><span class="token operator" style="color:#179299">=</span><span class="token plain">z</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> meshSize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">lc</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tag</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">x </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> y </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> y </span><span class="token operator" style="color:#179299">+</span><span class="token plain"> ly</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> z </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> z</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> lc </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> lc</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addPoint</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">x</span><span class="token operator" style="color:#179299">=</span><span class="token plain">x</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> y</span><span class="token operator" style="color:#179299">=</span><span class="token plain">y</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> z</span><span class="token operator" style="color:#179299">=</span><span class="token plain">z</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> meshSize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">lc</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tag</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">x </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> corner</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> y </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> y</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> z </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> z</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> lc </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> lc</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addPoint</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">x</span><span class="token operator" style="color:#179299">=</span><span class="token plain">x</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> y</span><span class="token operator" style="color:#179299">=</span><span class="token plain">y</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> z</span><span class="token operator" style="color:#179299">=</span><span class="token plain">z</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> meshSize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">lc</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tag</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addLine</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addLine</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addLine</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addLine</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addCurveLoop</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">[</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token plain">]</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tag</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%addPlaneSurface</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">[</span><span class="token number" style="color:#dc8a78">1</span><span class="token plain">]</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%geo%synchronize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">option%setNumber</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">VALUE</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> name</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"Mesh.SaveAll"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%mesh%generate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">model%mesh%setOrder</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">order</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">WRITE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.msh'</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">ierr </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> gmsh</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Finalize</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.msh'</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> STATUS</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"OLD"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ACTION</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"READ"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">READ</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">title</span><span class="token operator" style="color:#179299">//</span><span class="token string" style="color:#df8e1d">'.h5'</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> MODE</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"NEW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Export</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">hdf5</span><span class="token operator" style="color:#179299">=</span><span class="token plain">hdf5file</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> group</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">""</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> mshFile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> hdf5file</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <author>
            <name>Shion Shimizu</name>
            <uri>https://github.com/shishiousan</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="gmsh" term="gmsh"/>
        <category label="tutorial" term="tutorial"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Setting up a new kernel using EASIFEM]]></title>
        <id>https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem</id>
        <link href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem"/>
        <updated>2025-05-11T09:05:24.000Z</updated>
        <summary type="html"><![CDATA[This post provides definition of Kernel in EASIFEM and provides a step by step guide to create a new kernel.]]></summary>
        <content type="html"><![CDATA[<p>This post explains the meaning of kernel in EASIFEM platform. It also describe the steps to create a new kernel in EASIFEM.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-kernel">What is a kernel?<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#what-is-a-kernel" class="hash-link" aria-label="Direct link to What is a kernel?" title="Direct link to What is a kernel?">​</a></h2>
<p>A kernel is a computer program written in object oriented programming paradigm which attempts to solve a partial differential equation. In easifem, the term kernel is used for solving a particular PDE.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Why particular PDE?</div><div class="admonitionContent_BuS1"><p>In our experience when we focus on solving a particular PDE, we can design the kernel quickly and more efficiently. This is because the kernel has specific tasks to perform with limited number of kernel parameters. We believe that this is a good balance between flexibility, efficiency and speed of development. In the past, we have tried to create a generic PDE solver type kernel but after few years the kernel became too complex and difficult to maintain by a group of developers. Therefore, we want to define a kernel for a specific PDE.</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Is kernel flexible?</div><div class="admonitionContent_BuS1"><p>Yes, the kernel has sufficient amount of flexibility. For example, the coefficient of PDE can be constant, spatially changing or time dependent. The boundary condition can also be constant, space, time, or space-time dependent.</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Kernel is blend of procedural programming and object oriented programming?</div><div class="admonitionContent_BuS1"><p>A kernel is a blend of procedural programming and object oriented programming. The procedural programming comes into the picture because a kernel is trying to solve a specific PDE by using a specific method. In this sense, the kernel's design is driven keeping procedure programming in mind. However, a kernel can solve several problems governed by the same PDE. These problems can have different types of boundary conditions and material properties. Also, we can use several numerical methods to solve the problem. In order to facilitate these objectives, we use object oriented programming.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="git-ignore-file">Git ignore file<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#git-ignore-file" class="hash-link" aria-label="Direct link to Git ignore file" title="Direct link to Git ignore file">​</a></h2>
<p>Add the following <code>.gitignore</code> file in the root directory of your kernel. This will help you to ignore the unnecessary files which are not required for the kernel.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Git ignore file for EASIFEM projects</summary><div><div class="collapsibleContent_i85q"><div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.a</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.mod</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.smod</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.o</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.out</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.i90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.if90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.DS_Store</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.prj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.drawio</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.log</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.eps</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.h5</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.gp</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.msh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.vtu</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.ipynb</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.dat</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.mtx</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.eps</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.pdf</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.geo</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.ps</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.png</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.jpg</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.plt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.csv</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*/build/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">**/build</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">build/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">_packages/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">__*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">log.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">test.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">## Obsidian related</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.obsidian</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># VSCode related</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">vscode-settings</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.vscode/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">settings.json</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">## Docusaurus related</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">logs</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.log</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">npm-debug.log*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">yarn-debug.log*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">yarn-error.log*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">lerna-debug.log*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.pnpm-debug.log*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Diagnostic reports (https://nodejs.org/api/report.html)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">report.</span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">0</span><span class="token plain">-9</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain">*.</span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">0</span><span class="token plain">-9</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain">*.</span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">0</span><span class="token plain">-9</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain">*.</span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">0</span><span class="token plain">-9</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain">*.json</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Runtime data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">pids</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.pid</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.seed</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.pid.lock</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Directory for instrumented libs generated by jscoverage/JSCover</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">lib-cov</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Coverage directory used by tools like istanbul</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">coverage</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.lcov</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># nyc test coverage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.nyc_output</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.grunt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Bower dependency directory (https://bower.io/)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">bower_components</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># node-waf configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.lock-wscript</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Compiled binary addons (https://nodejs.org/api/addons.html)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">build/Release</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Dependency directories</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">node_modules/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">jspm_packages/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Snowpack dependency directory (https://snowpack.dev/)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">web_modules/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># TypeScript cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.tsbuildinfo</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Optional npm cache directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.npm</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Optional eslint cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.eslintcache</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Optional stylelint cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.stylelintcache</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Microbundle cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.rpt2_cache/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.rts2_cache_cjs/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.rts2_cache_es/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.rts2_cache_umd/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Optional REPL history</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.node_repl_history</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Output of 'npm pack'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">*.tgz</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Yarn Integrity file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.yarn-integrity</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># dotenv environment variable files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.env</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.env.development.local</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.env.test.local</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.env.production.local</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.env.local</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># parcel-bundler cache (https://parceljs.org/)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.cache</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.parcel-cache</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Next.js build output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.next</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">out</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Nuxt.js build / generate output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.nuxt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">dist</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Gatsby files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.cache/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Comment in the public line in if your project uses Gatsby and not Next.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># https://nextjs.org/blog/next-9-1#public-directory-support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># public</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># vuepress build output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.vuepress/dist</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># vuepress v2.x temp and cache directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.temp</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.cache</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Docusaurus cache and generated files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.docusaurus</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Serverless directories</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.serverless/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># FuseBox cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.fusebox/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># DynamoDB Local files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.dynamodb/</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># TernJS port file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.tern-port</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Stores VSCode versions used for testing VSCode extensions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.vscode-test</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># yarn v2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.yarn/cache</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.yarn/unplugged</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.yarn/build-state.yml</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.yarn/install-state.gz</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.pnp.*</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">.DS_Store</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token builtin class-name" style="color:#fe640b">.</span><span class="token variable" style="color:#4ca5e5">$*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">~*</span><br></span></code></pre></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="directory-structure">Directory structure<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#directory-structure" class="hash-link" aria-label="Direct link to Directory structure" title="Direct link to Directory structure">​</a></h2>
<p>Create following directory in the root directory of your kernel.</p>
<ol>
<li>src: This directory will contain the source code of your kernel.</li>
<li>docs: This directory will contain the documentation of your kernel.</li>
<li>tests: This directory will contain the test code of your kernel.</li>
<li>examples: This directory will contain the example code and tutorials of your kernel.</li>
<li>cmake: This directory will contain the cmake files necessary to build your kernel.</li>
<li>docker: This directory will contain the docker files.</li>
<li>bin: This directory will contain the binary files of application based on your kernel</li>
<li>media: This directory will contain the figures and images used for the documentation</li>
<li>pages: This directory will contain the pages for documentation by using ford.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="structure-of-src-directory">Structure of <code>src</code> directory<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#structure-of-src-directory" class="hash-link" aria-label="Direct link to structure-of-src-directory" title="Direct link to structure-of-src-directory">​</a></h2>
<p>The <code>src</code> directory will contain the following directories and files.</p>
<ul>
<li><code>modules</code>: This directory contains the header files of the kernel. These header files are called modules.</li>
<li><code>submodules</code>: This directory contains the <code>submodules</code> of the kernel. These <code>submodules</code> are contains the implementation of the header files.</li>
</ul>
<p>Let us say you want to develop a class called <code>Abstract1DUVSTFEM_</code> (note that all user defined data types end with an underscore). Then you should create a directory called <code>Abstract1DUVSTFEM</code> in the <code>src/modules</code> directory.</p>
<p>Now in <code>Abstract1DUVSTFEM</code> directory create another directory called <code>src</code> which will contain the header file. In this source directory you will create <code>Abstract1DUVSTFEM_Class.F90</code>.</p>
<p>In <code>Abstract1DUVSTFEM</code> directory create a file called <code>CMakeLists.txt</code>. The content of this is given below.</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">modules/Abstract1DUVSTFEM/CMakeLists.txt</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">src_path </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_LIST_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">/src/"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">target_sources</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token namespace">PRIVATE</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">src_path</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/Abstract1DUVSTFEM_Class.F90</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>If you follow the above steps the src directory will look like the following.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">├── modules</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; └── Abstract1DUVSTFEM</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp;     ├── CMakeLists.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp;     └── src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp;         └── Abstract1DUVSTFEM_Class.F90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">└── submodules</span><br></span></code></pre></div></div>
<p>Now we will implement the methods defined in <code>Abstract1DUVSTFEM_Class.F90</code> in the <code>src/submodules</code> directory. Create a directory called <code>Abstract1DUVSTFEM</code> in the <code>src/submodules</code> directory. In this directory create a file called <code>CMakeLists.txt</code>. In this directory create a directory called <code>src</code> which will contain the submodules of module <code>Abstract1DUVSTFEM_Class</code>. The structure of the directory will look like this.</p>
<p>The content of <code>CMakeLists.txt</code> file will be as follows.</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">submodules/Abstract1DUVSTFEM/CMakeLists.txt</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">src_path </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_LIST_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">/src/"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">target_sources</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token namespace">PRIVATE</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">src_path</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/Abstract1DUVSTFEM_Class@ApplyDirichletBCMethods.F90</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">├── modules</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; └── Abstract1DUVSTFEM</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp;     ├── CMakeLists.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp;     └── src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp;         └── Abstract1DUVSTFEM_Class.F90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">└── submodules</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    ├── Abstract1DUVSTFEM</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    │&nbsp;&nbsp; └── src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    │&nbsp;&nbsp;     ├── Abstract1DUVSTFEM_Class@ApplyDirichletBCMethods.F90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    └── CMakeLists.txt</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="module-and-submodule-cmake-file">Module and Submodule CMake file<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#module-and-submodule-cmake-file" class="hash-link" aria-label="Direct link to Module and Submodule CMake file" title="Direct link to Module and Submodule CMake file">​</a></h2>
<p>In <code>modules</code> and <code>submodules</code> directory create a file called <code>CMakeLists.txt</code>. The CMake file will look like this.</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">modules/CMakeLists.txt</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token comment" style="color:#5c5f77;font-style:italic"># AbstractSTFEM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_LIST_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/Abstract1DUVSTFEM/CMakeLists.txt</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">submodules/CMakeLists.txt</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token comment" style="color:#5c5f77;font-style:italic"># AbstractSTFEM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_LIST_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/Abstract1DUVSTFEM/CMakeLists.txt</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>Now the structure of the <code>src</code> directory will look like this.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">├── modules</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; ├── Abstract1DUVSTFEM</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; │&nbsp;&nbsp; ├── CMakeLists.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; │&nbsp;&nbsp; └── src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; │&nbsp;&nbsp;     └── Abstract1DUVSTFEM_Class.F90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">│&nbsp;&nbsp; └── CMakeLists.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">└── submodules</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    ├── Abstract1DUVSTFEM</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    │&nbsp;&nbsp; ├── CMakeLists.txt</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    │&nbsp;&nbsp; └── src</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    │&nbsp;&nbsp;     ├── Abstract1DUVSTFEM_Class@ApplyDirichletBCMethods.F90</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    ├── CMakeLists.txt</span><br></span></code></pre></div></div>
<p>Now we need to write the main <code>CMakeLists.txt</code> file in the root of our project. That is, the parent directory of <code>src</code> directory. We will describe the content of this file in another blog post.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click here to see the content</summary><div><div class="collapsibleContent_i85q"><div><div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">CMakeLists.txt</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">cmake_minimum_required</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token property">VERSION</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3.20.0</span><span class="token plain"> FATAL_ERROR</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"easifemOneDimElasticity"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">project</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">enable_language</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">Fortran C CXX</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">VERSION_MAJOR </span><span class="token string" style="color:#df8e1d">"25"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">VERSION_MINOR </span><span class="token string" style="color:#df8e1d">"04"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">VERSION_BugFix </span><span class="token string" style="color:#df8e1d">"1"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">PROJECT_VERSION</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">VERSION_MAJOR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">.</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">VERSION_MINOR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">.</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">VERSION_BugFix</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_PROJECT_DESCRIPTION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d"> is  part of EASIFEM platform.</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token string" style="color:#df8e1d">    EASIFEM: Expandable and Scalable Infrastructure for Finite Element Methods.</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token string" style="color:#df8e1d">    This program solves one dimensional wave propogation problems using finite element</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token string" style="color:#df8e1d">    methods including space-time finite element methods.</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token string" style="color:#df8e1d">    "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_PROJECT_HOMEPAGE_URL</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"https://www.easifem.com"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">TARGETS_EXPORT_NAME </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">Targets"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">namespace </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">CMakePrintHelpers</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">FortranCInterface</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">FortranCInterface_VERIFY</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-DUSE_CMAKE"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># find my cmake modules here...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND </span><span class="token variable" style="color:#4ca5e5">CMAKE_MODULE_PATH</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_SOURCE_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/cmake/Modules</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># check error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token string" style="color:#df8e1d">" </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_SOURCE_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token plain"> </span><span class="token operator" style="color:#179299">STREQUAL</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">" </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    FATAL_ERROR</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"[ERROR] :: Build directory and Source directory cannot be same."</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># make directories include(${PROJECT_SOURCE_DIR}/cmake/makeDirs.cmake)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">GNUInstallDirs</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_MODULE_DIRECTORY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_INCLUDEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_LIBRARY_OUTPUT_DIRECTORY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_LIBDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_ARCHIVE_OUTPUT_DIRECTORY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_LIBDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_RUNTIME_OUTPUT_DIRECTORY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_BINDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">INSTALL_LIBDIR</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_LIBDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token variable" style="color:#4ca5e5">CACHE</span><span class="token plain"> PATH </span><span class="token string" style="color:#df8e1d">"Installation location of lib"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">INSTALL_INCLUDEDIR</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_INCLUDEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token variable" style="color:#4ca5e5">CACHE</span><span class="token plain"> PATH </span><span class="token string" style="color:#df8e1d">"Installation location of module files"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">INSTALL_BINDIR</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_BINDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token variable" style="color:#4ca5e5">CACHE</span><span class="token plain"> PATH </span><span class="token string" style="color:#df8e1d">"Installation location of binary files"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">WIN32</span><span class="token plain"> </span><span class="token operator" style="color:#179299">AND</span><span class="token plain"> </span><span class="token operator" style="color:#179299">NOT</span><span class="token plain"> </span><span class="token variable" style="color:#4ca5e5">CYGWIN</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DEF_INSTALL_CMAKEDIR CMake</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">else</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DEF_INSTALL_CMAKEDIR share/cmake/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">INSTALL_CMAKEDIR</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">DEF_INSTALL_CMAKEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token variable" style="color:#4ca5e5">CACHE</span><span class="token plain"> PATH </span><span class="token string" style="color:#df8e1d">"Installation directory for CMake files"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">foreach</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">p LIB BIN INCLUDE CMAKE</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">file</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">TO_NATIVE_PATH </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_INSTALL_PREFIX</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">p</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> _path</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">STATUS </span><span class="token string" style="color:#df8e1d">"Installing </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">p</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d"> componenets to </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">_path</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endforeach</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">option</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">BUILD_SHARED_LIBS</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Build shared library"</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">ON</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">BUILD_SHARED_LIBS</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">STATUS </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d"> will be built as a shared library."</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">add_library</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token namespace">SHARED</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">""</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">set_property</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">TARGET </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> PROPERTY </span><span class="token property">POSITION_INDEPENDENT_CODE</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">TRUE</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">else</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">STATUS </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d"> will be built as a static library."</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">add_library</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token namespace">STATIC</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">""</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  STATUS</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"[INFO] :: Is the Fortran compiler loaded? </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_LOADED</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_LOADED</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">STATUS </span><span class="token string" style="color:#df8e1d">"[INFO] :: Fortran compiler: </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_ID</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    STATUS</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"[INFO] :: Fortran compiler version is: </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_VERSION</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">NOT</span><span class="token plain"> </span><span class="token variable" style="color:#4ca5e5">CMAKE_BUILD_TYPE</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">CMAKE_BUILD_TYPE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      Release</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token variable" style="color:#4ca5e5">CACHE</span><span class="token plain"> STRING </span><span class="token string" style="color:#df8e1d">"Build type"</span><span class="token plain"> FORCE</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_ID</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token operator" style="color:#179299">STREQUAL</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"GNU"</span><span class="token plain"> </span><span class="token operator" style="color:#179299">OR</span><span class="token plain"> Fortran_COMPILER_NAME </span><span class="token operator" style="color:#179299">MATCHES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                                  </span><span class="token string" style="color:#df8e1d">"gfortran*"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    APPEND</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    FORTRAN_FLAGS</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-ffree-form"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-ffree-line-length-none"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-std=f2018"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-fimplicit-none"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-fno-range-check"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND FORTRAN_FLAGS_RELEASE </span><span class="token string" style="color:#df8e1d">"-O3"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token variable" style="color:#4ca5e5">APPLE</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      APPEND</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      FORTRAN_FLAGS_DEBUG</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-fbounds-check"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-g"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-fbacktrace"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-Wextra"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-Wall"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token comment" style="color:#5c5f77;font-style:italic"># "-fprofile-arcs"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-ftest-coverage"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-Wimplicit-interface"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">else</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      APPEND</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      FORTRAN_FLAGS_DEBUG</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-fbounds-check"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-g"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-fbacktrace"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-Wextra"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-Wall"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token comment" style="color:#5c5f77;font-style:italic"># "-fprofile-arcs"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-ftest-coverage"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">      </span><span class="token string" style="color:#df8e1d">"-Wimplicit-interface"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">elseif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_ID</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token operator" style="color:#179299">STREQUAL</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Intel"</span><span class="token plain"> </span><span class="token operator" style="color:#179299">OR</span><span class="token plain"> Fortran_COMPILER_NAME</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                                        </span><span class="token operator" style="color:#179299">MATCHES</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"ifort*"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND FORTRAN_FLAGS </span><span class="token string" style="color:#df8e1d">"-r8"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-W1"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND FORTRAN_FLAGS_RELEASE </span><span class="token string" style="color:#df8e1d">"-O3"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    APPEND</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    FORTRAN_FLAGS_DEBUG</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-O0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-traceback"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-g"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-debug all"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-check all"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-ftrapuv"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"-warn"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"nointerfaces"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">elseif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_COMPILER_ID</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token operator" style="color:#179299">STREQUAL</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"XL"</span><span class="token plain"> </span><span class="token operator" style="color:#179299">OR</span><span class="token plain"> Fortran_COMPILER_NAME</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                                                     </span><span class="token operator" style="color:#179299">MATCHES</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"xlf*"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND FORTRAN_FLAGS </span><span class="token string" style="color:#df8e1d">"-q64"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-qrealsize=8"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-qsuffix=f=f90:cpp=f90"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND FORTRAN_FLAGS_RELEASE </span><span class="token string" style="color:#df8e1d">"-O3"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-qstrict"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND FORTRAN_FLAGS_DEBUG </span><span class="token string" style="color:#df8e1d">"-O0"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-g"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-qfullpath"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"-qkeepparm"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">else</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">ERROR </span><span class="token string" style="color:#df8e1d">"[ERROR] :: No optimized Fortran compiler flags are known"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">cmake_print_variables</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">FORTRAN_FLAGS</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">cmake_print_variables</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">FORTRAN_FLAGS_RELEASE</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">cmake_print_variables</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">FORTRAN_FLAGS_DEBUG</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># include(${PROJECT_SOURCE_DIR}/cmake/targetCompileOpts.cmake)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">target_compile_options</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token namespace">PRIVATE</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">TARGET_COMPILE_OPT</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">FORTRAN_FLAGS</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">          </span><span class="token string" style="color:#df8e1d">"$&lt;$&lt;CONFIG:Debug&gt;:</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">FORTRAN_FLAGS_DEBUG</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">&gt;"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">          </span><span class="token string" style="color:#df8e1d">"$&lt;$&lt;CONFIG:Release&gt;:</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">FORTRAN_FLAGS_RELEASE</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">&gt;"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># include(${PROJECT_SOURCE_DIR}/cmake/targetIncludeDirs.cmake)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">target_include_directories</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token namespace">PUBLIC</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">$&lt;</span><span class="token plain">BUILD_INTERFACE:</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_MODULE_DIRECTORY</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                         </span><span class="token punctuation" style="color:#dd7878">$&lt;</span><span class="token plain">INSTALL_INTERFACE:</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_INCLUDEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">&gt;</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># include(${PROJECT_SOURCE_DIR}/cmake/targetProperties.cmake) target properties</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">set_target_properties</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token namespace">PROPERTIES</span><span class="token plain"> </span><span class="token property">POSITION_INDEPENDENT_CODE</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">SOVERSION</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">VERSION_MAJOR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">OUTPUT_NAME</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">LIBRARY_OUTPUT_DIRECTORY</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_LIBRARY_OUTPUT_DIRECTORY</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">ARCHIVE_OUTPUT_DIRECTORY</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_LIBRARY_OUTPUT_DIRECTORY</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">RUNTIME_OUTPUT_DIRECTORY</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_RUNTIME_OUTPUT_DIRECTORY</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">MACOSX_RPATH</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">ON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             </span><span class="token property">WINDOWS_EXPORT_ALL_SYMBOLS</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">ON</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># include(${PROJECT_SOURCE_DIR}/cmake/targetCompileDefs.cmake)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">option</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_REAL32 </span><span class="token boolean" style="color:#dc8a78">OFF</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">option</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_REAL64 </span><span class="token boolean" style="color:#dc8a78">ON</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_REAL32</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-DUSE_Real32"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_REAL64</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-DUSE_Real64"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">option</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_INT32 </span><span class="token boolean" style="color:#dc8a78">ON</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_INT32</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-DUSE_Int32"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">option</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_INT64 </span><span class="token boolean" style="color:#dc8a78">OFF</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">USE_INT64</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-DUSE_Int64"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-D</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_HOST_SYSTEM_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">_SYSTEM"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># DEFINE DEBUG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_BUILD_TYPE</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token operator" style="color:#179299">STREQUAL</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Debug"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">list</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">APPEND TARGET_COMPILE_DEF </span><span class="token string" style="color:#df8e1d">"-DDEBUG_VER"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># include(${PROJECT_SOURCE_DIR}/cmake/install.cmake) Installation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">install</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  DIRECTORY </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_Fortran_MODULE_DIRECTORY</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  DESTINATION </span><span class="token string" style="color:#df8e1d">"./"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  COMPONENT </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">install</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  EXPORT </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">TARGETS_EXPORT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  FILE </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">TARGETS_EXPORT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">.cmake"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  NAMESPACE </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">namespace</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">::</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  DESTINATION </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_CMAKEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  COMPONENT </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">CMakePackageConfigHelpers</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">write_basic_package_version_file</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">/</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">ConfigVersion.cmake"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token property">VERSION</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_VERSION</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  COMPATIBILITY AnyNewerVersion</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">configure_package_config_file</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_SOURCE_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/cmake/Config.cmake.in</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">/</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain">Config.cmake</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  INSTALL_DESTINATION </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_CMAKEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  PATH_VARS INSTALL_INCLUDEDIR</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">install</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  FILES </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">/</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">Config.cmake"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">        </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_BINARY_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">/</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">ConfigVersion.cmake"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  DESTINATION </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_CMAKEDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  COMPONENT </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">-dev"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># linking easifemClasses, </span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># this easifemClasses library is already linked with easifemBase</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># so no need to link with easifemBase again.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">find_package</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">easifemClasses REQUIRED</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">if</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">easifemBase_FOUND</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">STATUS </span><span class="token string" style="color:#df8e1d">"FOUND easifemClasses"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">else</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">ERROR </span><span class="token string" style="color:#df8e1d">"NOT FOUND easifemClasses"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">endif</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">target_link_libraries</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token namespace">PUBLIC</span><span class="token plain"> </span><span class="token inserted class-name">easifemClasses::easifemClasses</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># Add source files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">src/modules/CMakeLists.txt</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">src/submodules/CMakeLists.txt</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># this should be in the end.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">target_compile_definitions</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token namespace">PUBLIC</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">TARGET_COMPILE_DEF</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">message</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">STATUS </span><span class="token string" style="color:#df8e1d">"[INFO] :: Compiler definition : </span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">TARGET_COMPILE_DEF</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">install</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  TARGETS </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">C_PROJECTS</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  EXPORT </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">TARGETS_EXPORT_NAME</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  COMPONENT </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">PROJECT_NAME</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  ARCHIVE DESTINATION </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_LIBDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  RUNTIME DESTINATION </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_BINDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  LIBRARY DESTINATION </span><span class="token punctuation" style="color:#dd7878">${</span><span class="token plain">INSTALL_LIBDIR</span><span class="token punctuation" style="color:#dd7878">}</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># include(${PROJECT_SOURCE_DIR}/cmake/packaging.cmake)</span><br></span></code></pre></div></div></div></div></div></details>
<p>The above see make file needs <code>Config.cmake.in</code> file. The content of this file is given below.</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">Config.cmake.in</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">@PACKAGE_INIT@</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">FIND_PACKAGE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">easifemClasses REQUIRED</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">set_and_check</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token string" style="color:#df8e1d">"@PROJECT_NAME@_INCLUDE_DIR"</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"@PACKAGE_INSTALL_INCLUDEDIR@"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">include</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token string" style="color:#df8e1d">"</span><span class="token string interpolation punctuation" style="color:#dd7878">${</span><span class="token string interpolation variable" style="color:#4ca5e5">CMAKE_CURRENT_LIST_DIR</span><span class="token string interpolation punctuation" style="color:#dd7878">}</span><span class="token string" style="color:#df8e1d">/@TARGETS_EXPORT_NAME@.cmake"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token function" style="color:#1e66f5">check_required_components</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">    </span><span class="token string" style="color:#df8e1d">"@PROJECT_NAME@"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-for-easifem-cli">Configuration for easifem CLI.<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#configuration-for-easifem-cli" class="hash-link" aria-label="Direct link to Configuration for easifem CLI." title="Direct link to Configuration for easifem CLI.">​</a></h2>
<p>Now that we have added the source code and setup the CMake files. We need to specify the toml configuration files for the kernel, so that we can build and install easifemOneDimElasticity kernel using easifem CLI. To do so, create a file called <code>oneDimElasticity.toml</code> in the directory where easifem plugins are kept. In our case it is kept at <code>~/.config/easifem/plugins/oneDimElasticity.toml</code>. The content of this file is given below.</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockTitle_OeMC">oneDimElasticity.toml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"oneDimElasticity"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isActive</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">buildSystem</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"cmake"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">git</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">'github.com/easifem/oneDimElasticity.git'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">sourceDir</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"${HOME}/Dropbox/easifem/oneDimElasticity"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">installDir</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"${HOME}/.easifem/install/oneDimElasticity/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">buildType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Debug"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">buildSharedLibs</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">buildStaticLibs</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">libName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"easifemOneDimElasticity"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">targetName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"easifemOneDimElasticity"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">projectName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"easifemOneDimElasticity"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">runtest</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">license</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"GPL3"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># buildOptions = [ "-D USE_GMSH_SDK:BOOL=ON"]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">dependencies</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">[</span><span class="token string" style="color:#df8e1d">"classes"</span><span class="token punctuation" style="color:#dd7878">]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-the-kernel-by-using-easifem-cli">Building the kernel by using easifem CLI<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#building-the-kernel-by-using-easifem-cli" class="hash-link" aria-label="Direct link to Building the kernel by using easifem CLI" title="Direct link to Building the kernel by using easifem CLI">​</a></h2>
<p>To build the kernel using easifem CLI, run the following command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">easifem dev oneDimElasticity</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-kernel-by-using-easifem-cli">Installing the kernel by using easifem CLI<a href="https://www.easifem.com/blog/how-to-setup-a-new-kernel-in-easifem#installing-the-kernel-by-using-easifem-cli" class="hash-link" aria-label="Direct link to Installing the kernel by using easifem CLI" title="Direct link to Installing the kernel by using easifem CLI">​</a></h2>
<p>To install the kernel using easifem CLI, run the following command.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">easifem </span><span class="token function" style="color:#1e66f5">install</span><span class="token plain"> oneDimElasticity</span><br></span></code></pre></div></div>
<p>To install the kernel with downloading the files from git, that is, by using the local source files, use the following command. In this case you must specify the sourceDir option in the above toml file.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">easifem </span><span class="token function" style="color:#1e66f5">install</span><span class="token plain"> oneDimElasticity --no-download</span><br></span></code></pre></div></div>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <author>
            <name>Shion Shimizu</name>
            <uri>https://github.com/shishiousan</uri>
        </author>
        <category label="kernel" term="kernel"/>
        <category label="guide" term="guide"/>
        <category label="tutorial" term="tutorial"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Handling Dirichlet Bounding Conditions in easifem (Part 1)]]></title>
        <id>https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3</id>
        <link href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3"/>
        <updated>2024-08-22T05:33:02.000Z</updated>
        <summary type="html"><![CDATA[This post explains concept of FEDOF in easifem.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>To apply boundary condition in FEM computation, EASIFEM, provides a class called <a href="https://www.easifem.com/docs-api/DirichletBC/DirichletBC_">DirichletBC_</a>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><code>DirichletBC_</code> is a subclass of <a href="https://www.easifem.com/docs-api/AbstractBC">AbstractBC</a>.</p></div></div>
<p>To understand how <code>DirichletBC</code> works, lets consider an example of linear elasticity. Let's say we want to apply the following boundary condition.</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">u</mi><mo>=</mo><msub><mi mathvariant="bold">U</mi><mn>0</mn></msub><mo separator="true">,</mo><mtext>&nbsp;on&nbsp;</mtext><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">\mathbf{u} = \mathbf{U}_{0}, \text{ on } \Gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">u</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8805em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathbf">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord">&nbsp;on&nbsp;</span></span><span class="mord">Γ</span></span></span></span></span>
<p>We may think that there is only one boundary condition. But in easifem this is not the case. Actually, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">\mathbf{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">u</span></span></span></span>, has three components in 3D (and two components in 2D). Therefore, the above boundary condition is actually boundary condition for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">u_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">u_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">u_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. So, we have three boundary condition on a given boundary <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">Γ</span></span></span></span>.</p>
<p>The second point, which is quite obvious, is that every boundary condition has two things:</p>
<ul>
<li>The boundary</li>
<li>The value (condition)</li>
</ul>
<p>To define the boundary EASIFEM employs the <a href="https://www.easifem.com/docs-api/MeshSelection">MeshSelection</a> class. The value can be specified in several ways as mentioned below in this section.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Several instances of DirichletBC can have same boundary but different condition.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-toml">Import from toml<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#import-from-toml" class="hash-link" aria-label="Direct link to Import from toml" title="Direct link to Import from toml">​</a></h2>
<p>We can initiate an instance of <code>DirichletBC_</code> by importing the information from a toml-file. To do so, we will use the method called <a href="https://www.easifem.com/docs-api/AbstractBC/ImportFromToml">ImportFromToml</a>.</p>
<p>Let us consider the following toml file</p>
<!-- -->
<!-- -->
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">domain</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">filename</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./mesh/square_3x3.h5"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">group</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">totalMedium</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"u"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">engine</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"NATIVE_SERIAL"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">fieldType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Normal"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">spaceCompo</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">timeCompo</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">fedofName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"space"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">geofedofName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"geofedof"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.geofedof</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseContinuity</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"H1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseInterpolation</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Lagrange"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">ipType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Equidistance"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Monomial"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.space</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseContinuity</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"H1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">baseInterpolation</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Hierarchical"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># ipType = "Equidistance"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># baseType = "Monomial"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">order</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">scaleForQuadOrder</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">quadOptName</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"quadOpt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">u.space.quadOpt</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isHomogeneous</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">quadratureType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"GaussLegendre"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic"># order = 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"left_bottom_fix"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">idof</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">nodalValueType</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Constant"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">value</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">10.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.boundary</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">isSelectionByMeshID</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token punctuation" style="color:#dd7878">[</span><span class="token table class-name">dbc.boundary.meshID</span><span class="token punctuation" style="color:#dd7878">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token key property">line</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">[</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">]</span><br></span></code></pre></div></div>
<p>We use the following code to import the boundary condition from the above toml file.</p>
<!-- -->
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token comment" style="color:#5c5f77;font-style:italic">!&gt; author: Vikas Sharma, Ph. D.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! date: 2025-10-23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! summary: Study of DirichletBC class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> GlobalData</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keywordExtra" style="color:#8839ef">ONLY</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain"> DFP</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> I4B</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> LGT</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ExceptionHandler_Class</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keywordExtra" style="color:#8839ef">ONLY</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain"> e</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> EXCEPTION_INFORMATION</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> DirichletBC_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FEDomain_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> AbstractMesh_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> FEDOF_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ScalarField_Class</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> Display_Method</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> ReallocateUtility</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">IMPLICIT NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> tomlFileName </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./test1.toml"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Types and variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">DirichletBC_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">FEDomain_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> dom</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">ScalarField_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> u</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">FEDOF_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Allocatables and pointers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">CLASS</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">AbstractMesh_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">POINTER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> cellMesh</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> boundaryMesh</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Setting the verbosity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! In Debug mode, there will many messages printed to the screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Following code suppress information-exception.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> e</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">setQuietMode</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">EXCEPTION_INFORMATION</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Domain: Initiate FEDomain and print info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"domain"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL dom%DisplayDomainInfo(msg="DomainInfo: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! ScalarField and FEDOF: Initiate scalarField and fedof</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> u</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"u"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> geofedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">geofedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                      filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL fedof%Display(msg="FEDOF info: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Import from toml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">ImportFromToml</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tomlFileName</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tomlName</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"dbc"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! CALL obj%Display("DirichletBC Info: ")</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the total node numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">tsize </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetTotalNodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"Total Node Num: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the node numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token operator" style="color:#179299">=</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnNode</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> iNodeOnEdge</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             iNodeOnFace</span><span class="token operator" style="color:#179299">=</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"tsize = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">tsize</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> orient</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ROW"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnNode</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnNode = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnFace</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnFace = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">iNodeOnEdge</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"iNodeOnEdge = "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! DirichletBC: Get the nodal values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Reallocate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> tsize</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> isExpand</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> expandFactor</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">fedof</span><span class="token operator" style="color:#179299">=</span><span class="token plain">fedof</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             nrow</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol</span><span class="token operator" style="color:#179299">=</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token plain">ncol</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodalValue: "</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">             full</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">[nrow</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> ncol]</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"[nrow, ncol]: "</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! Cleanup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">!----------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="learn-from-example">Learn from example<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#learn-from-example" class="hash-link" aria-label="Direct link to Learn from example" title="Direct link to Learn from example">​</a></h2>
<p>Let's consider the following example, in which we will specify the constant boundary condition.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click here to see the example</summary><div><div class="collapsibleContent_i85q"><div><div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keywordEnd" style="color:#209fb5">PROGRAM</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> easifemBase</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordExtra" style="color:#8839ef">USE</span><span class="token plain"> easifemClasses</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">IMPLICIT NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">DirichletBC_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">MeshSelection_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> boundary</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">ParameterList_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> param</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">Domain_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> dom</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">TYPE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token easifemTypes">HDF5File_</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> domainfile</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">CHARACTER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token operator" style="color:#179299">*</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">PARAMETER</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> domainfilename </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"./mesh3D.h5"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> bottom </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> top </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">2</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> left </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">3</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> right </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">4</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">                front </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">5</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> behind </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">6</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nsd</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">INTEGER</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">I4B</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodeNum</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordTypes" style="color:#04a5e5">REAL</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">ALLOCATABLE</span><span class="token plain"> </span><span class="token operator" style="color:#179299">::</span><span class="token plain"> nodalValue</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#dd7878">:</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> FPL_Init</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> param</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> domainfile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">filename</span><span class="token operator" style="color:#179299">=</span><span class="token plain">domainfilename</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> mode</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"READ"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> domainfile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">OPEN</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">domainfile</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> group</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">""</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">nsd </span><span class="token operator" style="color:#179299">=</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetNSD</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! We call Set SetAbstractBCParam to set the parameter for boundary condition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> SetAbstractBCParam</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#179299">=</span><span class="token plain">obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetPrefix</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"> name</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ZeroBC"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> idof</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodalValueType</span><span class="token operator" style="color:#179299">=</span><span class="token plain">Constant</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token comment" style="color:#5c5f77;font-style:italic">! We call SetMeshSelectionParam to set the parameter for boundary condition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> SetMeshSelectionParam</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#179299">=</span><span class="token plain">boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetPrefix</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"> isSelectionByMeshID</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Add</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nsd </span><span class="token operator" style="color:#179299">-</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> meshID</span><span class="token operator" style="color:#179299">=</span><span class="token plain">[top]</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">=</span><span class="token plain">boundary</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">constantNodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">0.0_DFP</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodeNum"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> advance</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"NO"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> Display</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> </span><span class="token string" style="color:#df8e1d">"nodalValue"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> advance</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"YES"</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> domainfile</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> param</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">DEALLOCATE</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">;</span><span class="token plain"> </span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> FPL_Finalize</span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keywordEnd" style="color:#209fb5">END PROGRAM</span><span class="token plain"> main</span><br></span></code></pre></div></div></div></div></div></details>
<p>In the above code, to define the boundary condition, we follow the steps given below.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-set-the-properties-of-the-dirichletbc">Step 1: Set the properties of the DirichletBC<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#step-1-set-the-properties-of-the-dirichletbc" class="hash-link" aria-label="Direct link to Step 1: Set the properties of the DirichletBC" title="Direct link to Step 1: Set the properties of the DirichletBC">​</a></h3>
<p>We set the properties of <code>DirichletBC_</code> by using the method called <a href="https://www.easifem.com/docs-api/AbstractBC/SetAbstractBCParam">SetAbstractBCParam</a>.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> SetAbstractBCParam</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#179299">=</span><span class="token plain">obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetPrefix</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"> name</span><span class="token operator" style="color:#179299">=</span><span class="token string" style="color:#df8e1d">"ZeroBC"</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> idof</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodalValueType</span><span class="token operator" style="color:#179299">=</span><span class="token plain">Constant</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Because we are setting constant boundary condition, we used <code>nodalValueType=Constant</code>.</p></div></div>
<p>You can learn more about this method <a href="https://www.easifem.com/docs-api/AbstractBC/SetAbstractBCParam">here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-define-a-boundary">Step 2: Define a boundary<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#step-2-define-a-boundary" class="hash-link" aria-label="Direct link to Step 2: Define a boundary" title="Direct link to Step 2: Define a boundary">​</a></h3>
<p>To define a boundary we will use the <a href="https://www.easifem.com/docs-api/MeshSelection">MeshSelection</a>. In the above code, we select the boundary by specifing the <code>meshID</code>.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> SetMeshSelectionParam</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> prefix</span><span class="token operator" style="color:#179299">=</span><span class="token plain">boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">GetPrefix</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain">  </span><span class="token punctuation" style="color:#dd7878">&amp;</span><span class="token plain"> isSelectionByMeshID</span><span class="token operator" style="color:#179299">=</span><span class="token boolean" style="color:#dc8a78">.TRUE.</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>After setting the boundary parameter we call <a href="https://www.easifem.com/docs-api/MeshSelection/Initiate">Initiate</a> method.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<p>Subsequently, we call <code>Add</code> method to add the information of <code>meshID</code>.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Add</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nsd </span><span class="token operator" style="color:#179299">-</span><span class="token plain"> </span><span class="token number" style="color:#dc8a78">1</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> meshID</span><span class="token operator" style="color:#179299">=</span><span class="token plain">[top]</span><span class="token punctuation" style="color:#dd7878">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token plain"></span><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>After adding the information of meshID we should call <a href="https://www.easifem.com/docs-api/MeshSelection/Set">Set</a> method, which means that we are done adding information to the boundary.</p></div></div>
<p>You can learn more about <code>SetMeshSelectionParam</code> <a href="https://www.easifem.com/docs-api/MeshSelection/SetMeshSelectionParam">here</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-initiate-instance-of-dirichletbc">Step 3: Initiate instance of <code>DirichletBC</code><a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#step-3-initiate-instance-of-dirichletbc" class="hash-link" aria-label="Direct link to step-3-initiate-instance-of-dirichletbc" title="Direct link to step-3-initiate-instance-of-dirichletbc">​</a></h3>
<p>After initiating the boundary, call <a href="https://www.easifem.com/docs-api/AbstractBC/Initiate">Initiate</a>. To initiate an instance of <code>DirichletBC_</code> we need to pass the boundary, paramters, and domain.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Initiate</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">param</span><span class="token operator" style="color:#179299">=</span><span class="token plain">param</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> boundary</span><span class="token operator" style="color:#179299">=</span><span class="token plain">boundary</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> dom</span><span class="token operator" style="color:#179299">=</span><span class="token plain">dom</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-set-the-boundary-condition">Step 4: Set the boundary condition<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#step-4-set-the-boundary-condition" class="hash-link" aria-label="Direct link to Step 4: Set the boundary condition" title="Direct link to Step 4: Set the boundary condition">​</a></h3>
<p>After initiating an instance of <code>DirichletBC_</code>, next step is to set the boundary condition. To do so, we will use the method <a href="https://www.easifem.com/docs-api/AbstractBC/Set">Set</a>.</p>
<p>While setting the value we should respect the configuration used while calling <code>SetAbstractBCParam</code>. For example, in the above example we configure boundary condition for <code>nodalValueType=Constant</code>. Therefore, we should set the <code>constantNodalValue</code> while calling the set method.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Set</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">constantNodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token number" style="color:#dc8a78">0.0_DFP</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-get-the-value-of-boundary-condition">Step 5: Get the value of boundary condition<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#step-5-get-the-value-of-boundary-condition" class="hash-link" aria-label="Direct link to Step 5: Get the value of boundary condition" title="Direct link to Step 5: Get the value of boundary condition">​</a></h3>
<p>To get the boundary condition we will use the method <a href="https://www.easifem.com/docs-api/AbstractBC/Get">Get</a>. The Get function can take two arguments <code>nodeNum(:)</code> and <code>nodalValue(:,:)</code>. The <code>nodeNum(:)</code> is compulsory, whereas <code>nodalValue</code> can be optional.</p>
<div class="language-fortran codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#4c4f69"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-fortran codeBlock_bY9V thin-scrollbar" style="color:#4c4f69;background:#e6e9ef"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#4c4f69;background:#e6e9ef"><span class="token keyword" style="color:#8839ef">CALL</span><span class="token plain"> obj</span><span class="token operator" style="color:#179299">%</span><span class="token easifemMethods" style="color:#d20f39">Get</span><span class="token punctuation" style="color:#dd7878">(</span><span class="token plain">nodeNum</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodeNum</span><span class="token punctuation" style="color:#dd7878">,</span><span class="token plain"> nodalValue</span><span class="token operator" style="color:#179299">=</span><span class="token plain">nodalValue</span><span class="token punctuation" style="color:#dd7878">)</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>On return, the size of <code>nodeNum</code> and <code>SIZE(nodalValue, 1)</code> is same.</p></div></div>
<p>The columns in <code>nodalValue</code> denotes the boundary condition at different times. You can read more about this subroutine <a href="https://www.easifem.com/docs-api/AbstractBC/Get">here</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further reading<a href="https://www.easifem.com/blog/DirichletBC/understanding-dirichletbc-3#further-reading" class="hash-link" aria-label="Direct link to Further reading" title="Direct link to Further reading">​</a></h2>
<p>There is more to <code>DirichletBC_</code>, and you can learn about them from following pages. (Here <code>DBC</code> stands for <code>DirichletBC_</code>)</p>
<div class="homepage-section"><div class="section-content"><a class="homepage-card" href="https://www.easifem.com/guides/programming-fem/dirichletBC/dbc_userfunc_const"><div class="card-content"><div class="title">Constant user function</div><div class="description">This example shows how to initiate DBC by using a constant UserFunction $u=\alpha$</div></div></a><a class="homepage-card" href="https://www.easifem.com/guides/programming-fem/dirichletBC/dbc_userfunc_space"><div class="card-content"><div class="title">Spatial user function</div><div class="description">This example shows how to initiate DBC by using a space dependent UserFunction, $u=g(x, y, z)$</div></div></a><a class="homepage-card" href="https://www.easifem.com/guides/programming-fem/dirichletBC/dbc_toml_const"><div class="card-content"><div class="title">Toml file constant value</div><div class="description">This example shows how to initiate DBC by reading a toml-file. Constant boundary condition, $u=\alpha$</div></div></a><a class="homepage-card" href="https://www.easifem.com/guides/programming-fem/dirichletBC/dbc_toml_userfunc_const"><div class="card-content"><div class="title">Toml file constant function</div><div class="description">This example shows how to initiate DBC by reading a toml-file. Constant boundary condition, $u=\alpha$</div></div></a><a class="homepage-card" href="https://www.easifem.com/guides/programming-fem/dirichletBC/dbc_toml_userfunc_const"><div class="card-content"><div class="title">Toml file space function</div><div class="description">This example shows how to initiate DBC by reading a toml-file. Space boundary condition, $u=g(x,y,z)$</div></div></a></div></div>]]></content>
        <author>
            <name>Vikas Sharma</name>
            <uri>https://github.com/vickysharma0812</uri>
        </author>
        <category label="mesh" term="mesh"/>
        <category label="fedof" term="fedof"/>
        <category label="dirichletBC" term="dirichletBC"/>
    </entry>
</feed>